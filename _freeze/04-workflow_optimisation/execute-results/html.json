{
  "hash": "a1878955181279dc22939938258d4ae4",
  "result": {
    "engine": "knitr",
    "markdown": "# Optimisation of a data analysis workflow {#sec-workflow-optimisation}\n\n\n::: {.cell}\n\n:::\n\n\nIn the previous chapter we have seen how to benchmark the data\nanalysis performance when starting from different types of data. This\nchapter presents how to assess the impact of different methods for the\nsame sequence of steps on the same data, effectively optimising the\nworkflow.\n\nTo illustrate the approach, we will again use the data set by\n[@Shen2018-gw], a spike-in data set with known ground truth. The\noptimisation focuses on two steps: we will explore different methods\nfor normalisation and summarisation.\n\n**Important**: the first sections of the chapter are again meant for \nadvanced users that are familiar with R scripting. Novice users\ninterested in the key messages and best practices can refer to the \n[take home message section](#sec-take_home).\n\n## Load packages\n\nWe load the `msqrob2` package, along with additional packages for data\nmanipulation and visualisation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"msqrob2\")\nlibrary(\"data.table\")\nlibrary(\"dplyr\")\nlibrary(\"tidyr\")\nlibrary(\"ggplot2\")\nlibrary(\"patchwork\")\nlibrary(\"tidyverse\")\n```\n:::\n\n\nWe also configure the [parallelisation](#sec-parallel) framework.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"BiocParallel\")\nregister(SerialParam())\n```\n:::\n\n\n## Data\n\nWe will reuse the data by [@Shen2018-gw] as in @sec-basics and\n@sec-benchmarking. The [data](#sec-ecoli_data) were reanalysed using\nMaxQuant, and we will use start from the evidence file as suggested in\nthe [previous chapter](#sec-benchmarking).\n\n### PSM table\n\nWe here retrieve the evidence file containig the [PSM\ntable](#sec-psm_table).\n\n**TODO**: put data on Zenodo or MsDataHub, and update code below\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# myurl <- \"https://github.com/statOmics/MSqRobSumPaper/raw/refs/heads/master/spikein/data/maxquant/evidence.zip\"\n# download.file(myurl,\"data/sticker2020/evidence.zip\", method = \"curl\", extra = \"-L\")\n# unzip(\"data/sticker2020/evidence.zip\", exdir = \"data/sticker2020/\")\nevidenceFile <- \"data/sticker2020/evidence.txt\"\n```\n:::\n\n\nWe also load the [annotation table](#sec-annotation_table)) that has\nbeen generated by the authors. Since the evidence, peptides and\nprotein-groups tables all contain the same samples, the annotation\ntable will be shared across the MaxQuant data tables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nannotFile <- \"data/sticker2020/sticker2020_annotation.csv\"\ncoldata <- read.csv(annotFile)\n```\n:::\n\n\nWe retrieve all the E. coli protein identifiers to later identify\nwhich proteins are known to be differentially abundant (E. coli\nproteins) or constant (human) across condition.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"BiocFileCache\")\nbfc <- BiocFileCache()\necoli <- bfcrpath(bfc, \"https://raw.githubusercontent.com/statOmics/MSqRobSumPaper/refs/heads/master/spikein/data/fasta/ecoli_up000000625_7_06_2018.fasta\")\necoli <- readLines(ecoli)\necoli <- ecoli[grepl(\"^>\", ecoli)]\necoli <- gsub(\">sp\\\\|(.*)\\\\|.*\", \"\\\\1\", ecoli)\n```\n:::\n\n\n### Convert to QFeatures\n\nWe combine the evidence file with the annotation table into a \n[`QFeatures` object](#sec-qfeatures).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspikein <- fread(evidenceFile, check.names = TRUE)\ncoldata$runCol <- coldata$Raw.file\n(spikein <- readQFeatures(\n    spikein, colData = coldata, runCol = \"Raw.file\", \n    quantCols = \"Intensity\"\n))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAn instance of class QFeatures (type: bulk) with 20 sets:\n\n [1] B03_02_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B: SummarizedExperiment with 40057 rows and 1 columns \n [2] B03_03_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B: SummarizedExperiment with 41266 rows and 1 columns \n [3] B03_04_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B: SummarizedExperiment with 41396 rows and 1 columns \n ...\n [18] B03_19_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B: SummarizedExperiment with 39388 rows and 1 columns \n [19] B03_20_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B: SummarizedExperiment with 39000 rows and 1 columns \n [20] B03_21_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B: SummarizedExperiment with 38783 rows and 1 columns \n```\n\n\n:::\n:::\n\n\nWe now have a `QFeatures` object with 20 sets, as many as the number\nof MS runs. We cannot yet join the sets together since we don't have a\nspecific feature identifier and the data does not fullfill to the\nmodelling assumptions, yet. We will therefore preprocess the data \nfirst.\n\n## Data preprocessing\n\nWe will follow the same data [preprocessing\nworkflow]({#sec-preprocess_evidence}) as in the previous chapter. We\nwill however explore different normalisation strategies and\nsummarisation methods.\n\n1. Encoding missing values as zeros.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspikein <- zeroIsNA(spikein, names(spikein))\n```\n:::\n\n\n2. Log2 transforming\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninputNames <- names(spikein)\nlogNames <- paste0(inputNames, \"_log\")\nspikein <- logTransform(spikein, inputNames, name = logNames, base = 2)\n```\n:::\n\n\n3. Keeping only the most intense PSM per ion (see \n   [here](#sec-duplicated_psms) for a step-by-step explanation of the\n   code). Upon this filtering every feature is unique to a ion\n   identifier (peptide sequence + charge), and we hence can join sets\n   using that identifier.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (i in logNames) {\n  rowdata <- rowData(spikein[[i]]) \n  rowdata$ionID <- paste0(rowdata$Sequence, rowdata$Charge) \n  rowdata$value <- assay(spikein[[i]])[, 1]\n  rowdata <- data.frame(rowdata) |>\n    group_by(ionID) |>\n    mutate(psmRank = rank(-value))\n  rowData(spikein[[i]])$psmRank <- rowdata$psmRank\n  rowData(spikein[[i]])$ionID <- rowdata$ionID\n}\nspikein <- filterFeatures(spikein, ~ psmRank == 1, keep = TRUE)\nspikein <- joinAssays(spikein, logNames, \"ions_log\", \"ionID\")\n```\n:::\n\n\n4. Feature filtering\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspikein <- filterFeatures(\n        spikein, ~ Proteins != \"\" & ## Remove failed protein inference\n          !grepl(\";\", Proteins) & ## Remove protein groups\n          Reverse != \"+\" & ## Remove decoys\n          (Potential.contaminant != \"+\") ## Remove contaminants\n)\n```\n:::\n\n\n5. Missing value filtering\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- ncol(spikein[[\"ions_log\"]])\nspikein <- filterNA(spikein, i = \"ions_log\", pNA = (n - 4) / n)\n```\n:::\n\n\n### Explore normalisation methods\n\n[Remember](#sec-norm) that normalisation aims to correct for\nsystematic fluctuations across samples, as illustrated by plotting the\nintensity distribution for each sample. The method applies the\nfollowing operation on each sample $i$ across all PSMs $p$:\n\n$$\ny_{ip}^{\\text{norm}} = y_{ip} - \\hat{\\mu}_i\n$$\n\nwith $\\mathbf{y}$ the log intensities and \\hat{\\mu}_i$ the norm\nfactor.\n\nWe previously showed that the [Median of Ratios](#sec-norm)\n(popularized by DESeq2) method could (partly) correct for these\nsystematic fluctuations. We abbreviate this method as the MedianOfRatios method.\nThe norm factor used by MedianOfRatios is estimated as follows:\n\n$$\n\\hat{\\mu}^\\text{MedianOfRatios}_i = \\text{median}(y_{i\\cdot} - \\frac{1}{n}\\sum\\limits_{i = 1}^ny_{i\\cdot})\n$$ \n\nWe create a new set called `ions_norm_MedianOfRatios` that contains the\nvalues normalised by MedianOfRatios.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npseudoRef <- rowMeans(assay(spikein[[\"ions_log\"]]), na.rm = TRUE)\nnfLog <- sweep(assay(spikein[[\"ions_log\"]]), MARGIN = 1, pseudoRef) |> \n  colMedians(na.rm = TRUE)\nspikein <- sweep(\n  spikein, MARGIN = 2, STATS = nfLog, \n  i = \"ions_log\", name = \"ions_norm_MedianOfRatios\"\n)\n```\n:::\n\n\nHowever, other methods exist, median centering being the most popular.\nMedian centering normalisation subtracts the median intensity of each\nsample from all its measurements. A key assumption for this method is\nthat the majority of proteins are not differentially abundant. We\nabbreviate this method as the MedianCentering method. The norm factor used by MedianOfRatios\nis estimated as follows:\n\n$$\n\\hat{\\mu}^\\text{MedianCentering}_i = \\text{median}(y_{i\\cdot})\n$$\n\nWe create a new set called `ions_norm_MedianCentering` that contains the\nvalues normalised by MedianCentering.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nspikein <- normalize(\n  spikein, method = \"center.median\", i = \"ions_log\", \n  name = \"ions_norm_MedianCentering\"\n)\n```\n:::\n\n\nWe visually explore the impact of the normalisation methods on the\nintensity distribution for each sample.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlongForm(\n  spikein[, , c(\"ions_norm_MedianOfRatios\", \"ions_norm_MedianCentering\")],\n  colvars = c(\"Concentration\", \"Condition\")\n) |>\n  data.frame() |> \n  mutate(normalisation = sub(\"ions_norm_\", \"\", assay)) |>\n  ggplot() +\n  aes(x = value,\n      colour = Condition,\n      group = colname) +\n  geom_density() +\n  facet_grid(~ normalisation, scales = \"free\") +\n  labs(title = \"Intensity distribution for all samples\",\n       subtitle = \"After normalisation\")\n```\n\n::: {.cell-output-display}\n![ ](04-workflow_optimisation_files/figure-html/wf_optimisation_after_norm-1.png){width=672}\n:::\n:::\n\n\nBoth the median centering and median or ratio normalisation achieve\nsimilar alignment of the intensity distributions. Although they appear\nvisually similar, we will see later that they can lead to different\nresults in statistical inference. \n\nNotice that the `QFeatures` object contains two diverging assays, one\nfor each normalisation method.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(spikein, interactive = TRUE)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-d4819b08fbfd6f733db1\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-d4819b08fbfd6f733db1\">{\"x\":{\"visdat\":{\"c1dd731564bc\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"c1dd731564bc\",\"attrs\":{\"c1dd731564bc\":{\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"x\":[-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,0,0],\"y\":[2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,1,1],\"xend\":[-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.5,0.5],\"yend\":[1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-0.10000000000000001,0.099999999999999978],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"color\":\"grey\",\"width\":0.29999999999999999,\"showarrow\":true},\"inherit\":true},\"c1dd731564bc.1\":{\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"x\":[-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,0,-0.5,0.5],\"y\":[2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,1,-0.10000000000000001,0.099999999999999978],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"color\":\"#CCCCCC\",\"size\":40},\"text\":[\"B03_02_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_03_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_04_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_05_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_06_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_07_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_08_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_09_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_10_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_11_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_12_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_13_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_14_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_15_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_16_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_17_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_18_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_19_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_20_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_21_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_02_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_03_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_04_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_05_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_06_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_07_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_08_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_09_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_10_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_11_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_12_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_13_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_14_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_15_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_16_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_17_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_18_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_19_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_20_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_21_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"ions_log\",\"ions_norm_MedianOfRatios\",\"ions_norm_MedianCentering\"],\"hoverinfo\":\"text\",\"inherit\":true},\"c1dd731564bc.2\":{\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"x\":[-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,0,-0.5,0.5],\"y\":[2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,1,-0.10000000000000001,0.099999999999999978],\"text\":[\"B03_02_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_03_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_04_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_05_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_06_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_07_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_08_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_09_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_10_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_11_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_12_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_13_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_14_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_15_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_16_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_17_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_18_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_19_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_20_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_21_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_02_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_03_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_04_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_05_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_06_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_07_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_08_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_09_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_10_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_11_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_12_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_13_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_14_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_15_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_16_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_17_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_18_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_19_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_20_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_21_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"ions_log\",\"ions_norm_MedianOfRatios\",\"ions_norm_MedianCentering\"],\"type\":\"scatter\",\"mode\":\"text\",\"hoverinfo\":\"text\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"showgrid\":false,\"showticklabels\":false,\"zeroline\":false},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"showgrid\":false,\"showticklabels\":false,\"zeroline\":false},\"showlegend\":false,\"hovermode\":\"closest\"},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[-9.5,-9.5,null,-8.5,-8.5,null,-7.5,-7.5,null,-6.5,-6.5,null,-5.5,-5.5,null,-4.5,-4.5,null,-3.5,-3.5,null,-2.5,-2.5,null,-1.5,-1.5,null,-0.5,-0.5,null,0.5,0.5,null,1.5,1.5,null,2.5,2.5,null,3.5,3.5,null,4.5,4.5,null,5.5,5.5,null,6.5,6.5,null,7.5,7.5,null,8.5,8.5,null,9.5,9.5,null,-9.5,0,null,-8.5,0,null,-7.5,0,null,-6.5,0,null,-5.5,0,null,-4.5,0,null,-3.5,0,null,-2.5,0,null,-1.5,0,null,-0.5,0,null,0.5,0,null,1.5,0,null,2.5,0,null,3.5,0,null,4.5,0,null,5.5,0,null,6.5,0,null,7.5,0,null,8.5,0,null,9.5,0,null,0,-0.5,null,0,0.5],\"y\":[2.7650000000000001,1.7649999999999999,null,2.9649999999999999,1.9649999999999999,null,3.165,2.165,null,2.8650000000000002,1.865,null,3.0649999999999999,2.0649999999999999,null,3.2650000000000001,2.2650000000000001,null,2.7650000000000001,1.7649999999999999,null,2.9649999999999999,1.9649999999999999,null,3.165,2.165,null,2.8650000000000002,1.865,null,3.0649999999999999,2.0649999999999999,null,3.2650000000000001,2.2650000000000001,null,2.7650000000000001,1.7649999999999999,null,2.9649999999999999,1.9649999999999999,null,3.165,2.165,null,2.8650000000000002,1.865,null,3.0649999999999999,2.0649999999999999,null,3.2650000000000001,2.2650000000000001,null,2.7650000000000001,1.7649999999999999,null,2.9649999999999999,1.9649999999999999,null,1.7649999999999999,1,null,1.9649999999999999,1,null,2.165,1,null,1.865,1,null,2.0649999999999999,1,null,2.2650000000000001,1,null,1.7649999999999999,1,null,1.9649999999999999,1,null,2.165,1,null,1.865,1,null,2.0649999999999999,1,null,2.2650000000000001,1,null,1.7649999999999999,1,null,1.9649999999999999,1,null,2.165,1,null,1.865,1,null,2.0649999999999999,1,null,2.2650000000000001,1,null,1.7649999999999999,1,null,1.9649999999999999,1,null,1,-0.10000000000000001,null,1,0.099999999999999978],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"color\":\"grey\",\"width\":0.29999999999999999,\"showarrow\":true},\"marker\":{\"color\":\"rgba(31,119,180,1)\",\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,0,-0.5,0.5],\"y\":[2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,1,-0.10000000000000001,0.099999999999999978],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"color\":\"#CCCCCC\",\"size\":40,\"line\":{\"color\":\"rgba(255,127,14,1)\"}},\"text\":[\"B03_02_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_03_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_04_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_05_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_06_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_07_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_08_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_09_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_10_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_11_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_12_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_13_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_14_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_15_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_16_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_17_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_18_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_19_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_20_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_21_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_02_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_03_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_04_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_05_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_06_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_07_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_08_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_09_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_10_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_11_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_12_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_13_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_14_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_15_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_16_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_17_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_18_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_19_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_20_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_21_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"ions_log\",\"ions_norm_MedianOfRatios\",\"ions_norm_MedianCentering\"],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\"],\"error_y\":{\"color\":\"rgba(255,127,14,1)\"},\"error_x\":{\"color\":\"rgba(255,127,14,1)\"},\"line\":{\"color\":\"rgba(255,127,14,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,0,-0.5,0.5],\"y\":[2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,2.165,1.865,2.0649999999999999,2.2650000000000001,1.7649999999999999,1.9649999999999999,1,-0.10000000000000001,0.099999999999999978],\"text\":[\"B03_02_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_03_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_04_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_05_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_06_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_07_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_08_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_09_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_10_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_11_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_12_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_13_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_14_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_15_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_16_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_17_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_18_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_19_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_20_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_21_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_02_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_03_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_04_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_05_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_06_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_07_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_08_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_09_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_10_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_11_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_12_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_13_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_14_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_15_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_16_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_17_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_18_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_19_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_20_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_21_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"ions_log\",\"ions_norm_MedianOfRatios\",\"ions_norm_MedianCentering\"],\"type\":\"scatter\",\"mode\":\"text\",\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\"],\"marker\":{\"color\":\"rgba(44,160,44,1)\",\"line\":{\"color\":\"rgba(44,160,44,1)\"}},\"error_y\":{\"color\":\"rgba(44,160,44,1)\"},\"error_x\":{\"color\":\"rgba(44,160,44,1)\"},\"line\":{\"color\":\"rgba(44,160,44,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n\n \n:::\n:::\n\n\n\n### Explore summarisation methods\n\nWith the data normalised, the next step is to\n[summarise](#sec-summarisation) ion-level intensities to obtain\nprotein-level expression values. In this chapter, we will compare \nthree summarisation methods:\n\n- **Robust summarisation** [@Sticker2020-rl], as we described in a \n  [previous chapter](#sec-summarisation). \n- **Median summarisation**, which calculates the median of the \n  log-transformed intensities of all peptides belonging to a protein \n  for each sample separately. While robust to outliers, it can be \n  heavily influenced by inconsistent peptide identification across \n  samples.\n- **Median polish summarisation**, a non-parametric iterative method \n  that decomposes the peptide-by-sample intensity matrix into peptide\n  effects (rows) and sample effects (columns). The resulting column\n  effects are used as the summarised protein abundances. It is robust\n  and much faster than model-based approaches.\n\nAll these summarisation methods are available in `MsCoreUtils` and can\nbe integrated feeded to `QFeatures`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"MsCoreUtils\")\nsummMethods <- c(\n  robustSummary = MsCoreUtils::robustSummary, \n  colMedians = colMedians, \n  medianPolish = MsCoreUtils::medianPolish\n)\n```\n:::\n\n\nWe will therefore create a loop that iterates over the normalised data\nsets and over the summarisation methods.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (i in c(\"ions_norm_MedianOfRatios\", \"ions_norm_MedianCentering\")) {\n  for (j in names(summMethods)) {\n    newSet <- paste0(\"proteins_\", sub(\"ions_norm_\", \"\", i), \"_\", j)\n    spikein <- aggregateFeatures(\n      spikein, i = i, \n      name = newSet,\n      fcol = \"Proteins\", \n      fun = summMethods[[j]],\n      na.rm = TRUE\n    )\n  }\n}\n```\n:::\n\n\nThe data processing is now complete. The `QFeatures` object now\ncontains a workflow of assays, from input PSMs to normalised and\nsummarised proteins. The data set contains 2 sets obtained using 2\nnormalisation methods, and each normalised set has been summarised\nwith 3 different methods.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(spikein, interactive = TRUE)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-7c69b60614a69657f496\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7c69b60614a69657f496\">{\"x\":{\"visdat\":{\"c1dd7a3c9aa6\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"c1dd7a3c9aa6\",\"attrs\":{\"c1dd7a3c9aa6\":{\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"x\":[-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,0,0,-1.5,-1.5,-1.5,1.5,1.5,1.5],\"y\":[3.7650000000000001,3.9649999999999999,4.165,3.8650000000000002,4.0650000000000004,4.2649999999999997,3.7650000000000001,3.9649999999999999,4.165,3.8650000000000002,4.0650000000000004,4.2649999999999997,3.7650000000000001,3.9649999999999999,4.165,3.8650000000000002,4.0650000000000004,4.2649999999999997,3.7650000000000001,3.9649999999999999,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,2,2,0.90000000000000002,0.90000000000000002,0.90000000000000002,1.1000000000000001,1.1000000000000001,1.1000000000000001],\"xend\":[-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-1.5,1.5,-2.5,-1.5,-0.5,0.5,1.5,2.5],\"yend\":[2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0.90000000000000002,1.1000000000000001,-0.24999999999999997,-0.049999999999999989,0.15000000000000002,-0.14999999999999997,0.050000000000000044,0.25],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"color\":\"grey\",\"width\":0.29999999999999999,\"showarrow\":true},\"inherit\":true},\"c1dd7a3c9aa6.1\":{\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"x\":[-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,0,-1.5,1.5,-2.5,-1.5,-0.5,0.5,1.5,2.5],\"y\":[3.7650000000000001,3.9649999999999999,4.165,3.8650000000000002,4.0650000000000004,4.2649999999999997,3.7650000000000001,3.9649999999999999,4.165,3.8650000000000002,4.0650000000000004,4.2649999999999997,3.7650000000000001,3.9649999999999999,4.165,3.8650000000000002,4.0650000000000004,4.2649999999999997,3.7650000000000001,3.9649999999999999,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,2,0.90000000000000002,1.1000000000000001,-0.24999999999999997,-0.049999999999999989,0.15000000000000002,-0.14999999999999997,0.050000000000000044,0.25],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"color\":\"#CCCCCC\",\"size\":40},\"text\":[\"B03_02_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_03_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_04_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_05_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_06_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_07_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_08_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_09_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_10_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_11_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_12_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_13_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_14_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_15_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_16_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_17_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_18_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_19_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_20_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_21_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_02_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_03_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_04_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_05_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_06_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_07_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_08_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_09_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_10_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_11_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_12_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_13_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_14_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_15_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_16_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_17_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_18_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_19_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_20_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_21_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"ions_log\",\"ions_norm_MedianOfRatios\",\"ions_norm_MedianCentering\",\"proteins_MedianOfRatios_robustSummary\",\"proteins_MedianOfRatios_colMedians\",\"proteins_MedianOfRatios_medianPolish\",\"proteins_MedianCentering_robustSummary\",\"proteins_MedianCentering_colMedians\",\"proteins_MedianCentering_medianPolish\"],\"hoverinfo\":\"text\",\"inherit\":true},\"c1dd7a3c9aa6.2\":{\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"x\":[-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,0,-1.5,1.5,-2.5,-1.5,-0.5,0.5,1.5,2.5],\"y\":[3.7650000000000001,3.9649999999999999,4.165,3.8650000000000002,4.0650000000000004,4.2649999999999997,3.7650000000000001,3.9649999999999999,4.165,3.8650000000000002,4.0650000000000004,4.2649999999999997,3.7650000000000001,3.9649999999999999,4.165,3.8650000000000002,4.0650000000000004,4.2649999999999997,3.7650000000000001,3.9649999999999999,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,2,0.90000000000000002,1.1000000000000001,-0.24999999999999997,-0.049999999999999989,0.15000000000000002,-0.14999999999999997,0.050000000000000044,0.25],\"text\":[\"B03_02_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_03_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_04_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_05_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_06_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_07_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_08_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_09_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_10_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_11_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_12_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_13_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_14_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_15_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_16_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_17_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_18_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_19_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_20_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_21_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_02_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_03_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_04_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_05_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_06_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_07_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_08_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_09_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_10_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_11_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_12_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_13_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_14_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_15_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_16_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_17_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_18_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_19_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_20_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_21_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"ions_log\",\"ions_norm_MedianOfRatios\",\"ions_norm_MedianCentering\",\"proteins_MedianOfRatios_robustSummary\",\"proteins_MedianOfRatios_colMedians\",\"proteins_MedianOfRatios_medianPolish\",\"proteins_MedianCentering_robustSummary\",\"proteins_MedianCentering_colMedians\",\"proteins_MedianCentering_medianPolish\"],\"type\":\"scatter\",\"mode\":\"text\",\"hoverinfo\":\"text\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"showgrid\":false,\"showticklabels\":false,\"zeroline\":false},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"showgrid\":false,\"showticklabels\":false,\"zeroline\":false},\"showlegend\":false,\"hovermode\":\"closest\"},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[-9.5,-9.5,null,-8.5,-8.5,null,-7.5,-7.5,null,-6.5,-6.5,null,-5.5,-5.5,null,-4.5,-4.5,null,-3.5,-3.5,null,-2.5,-2.5,null,-1.5,-1.5,null,-0.5,-0.5,null,0.5,0.5,null,1.5,1.5,null,2.5,2.5,null,3.5,3.5,null,4.5,4.5,null,5.5,5.5,null,6.5,6.5,null,7.5,7.5,null,8.5,8.5,null,9.5,9.5,null,-9.5,0,null,-8.5,0,null,-7.5,0,null,-6.5,0,null,-5.5,0,null,-4.5,0,null,-3.5,0,null,-2.5,0,null,-1.5,0,null,-0.5,0,null,0.5,0,null,1.5,0,null,2.5,0,null,3.5,0,null,4.5,0,null,5.5,0,null,6.5,0,null,7.5,0,null,8.5,0,null,9.5,0,null,0,-1.5,null,0,1.5,null,-1.5,-2.5,null,-1.5,-1.5,null,-1.5,-0.5,null,1.5,0.5,null,1.5,1.5,null,1.5,2.5],\"y\":[3.7650000000000001,2.7650000000000001,null,3.9649999999999999,2.9649999999999999,null,4.165,3.165,null,3.8650000000000002,2.8650000000000002,null,4.0650000000000004,3.0649999999999999,null,4.2649999999999997,3.2650000000000001,null,3.7650000000000001,2.7650000000000001,null,3.9649999999999999,2.9649999999999999,null,4.165,3.165,null,3.8650000000000002,2.8650000000000002,null,4.0650000000000004,3.0649999999999999,null,4.2649999999999997,3.2650000000000001,null,3.7650000000000001,2.7650000000000001,null,3.9649999999999999,2.9649999999999999,null,4.165,3.165,null,3.8650000000000002,2.8650000000000002,null,4.0650000000000004,3.0649999999999999,null,4.2649999999999997,3.2650000000000001,null,3.7650000000000001,2.7650000000000001,null,3.9649999999999999,2.9649999999999999,null,2.7650000000000001,2,null,2.9649999999999999,2,null,3.165,2,null,2.8650000000000002,2,null,3.0649999999999999,2,null,3.2650000000000001,2,null,2.7650000000000001,2,null,2.9649999999999999,2,null,3.165,2,null,2.8650000000000002,2,null,3.0649999999999999,2,null,3.2650000000000001,2,null,2.7650000000000001,2,null,2.9649999999999999,2,null,3.165,2,null,2.8650000000000002,2,null,3.0649999999999999,2,null,3.2650000000000001,2,null,2.7650000000000001,2,null,2.9649999999999999,2,null,2,0.90000000000000002,null,2,1.1000000000000001,null,0.90000000000000002,-0.24999999999999997,null,0.90000000000000002,-0.049999999999999989,null,0.90000000000000002,0.15000000000000002,null,1.1000000000000001,-0.14999999999999997,null,1.1000000000000001,0.050000000000000044,null,1.1000000000000001,0.25],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"color\":\"grey\",\"width\":0.29999999999999999,\"showarrow\":true},\"marker\":{\"color\":\"rgba(31,119,180,1)\",\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,0,-1.5,1.5,-2.5,-1.5,-0.5,0.5,1.5,2.5],\"y\":[3.7650000000000001,3.9649999999999999,4.165,3.8650000000000002,4.0650000000000004,4.2649999999999997,3.7650000000000001,3.9649999999999999,4.165,3.8650000000000002,4.0650000000000004,4.2649999999999997,3.7650000000000001,3.9649999999999999,4.165,3.8650000000000002,4.0650000000000004,4.2649999999999997,3.7650000000000001,3.9649999999999999,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,2,0.90000000000000002,1.1000000000000001,-0.24999999999999997,-0.049999999999999989,0.15000000000000002,-0.14999999999999997,0.050000000000000044,0.25],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"color\":\"#CCCCCC\",\"size\":40,\"line\":{\"color\":\"rgba(255,127,14,1)\"}},\"text\":[\"B03_02_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_03_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_04_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_05_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_06_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_07_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_08_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_09_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_10_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_11_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_12_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_13_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_14_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_15_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_16_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_17_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_18_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_19_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_20_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_21_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_02_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_03_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_04_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_05_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_06_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_07_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_08_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_09_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_10_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_11_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_12_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_13_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_14_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_15_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_16_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_17_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_18_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_19_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_20_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_21_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"ions_log\",\"ions_norm_MedianOfRatios\",\"ions_norm_MedianCentering\",\"proteins_MedianOfRatios_robustSummary\",\"proteins_MedianOfRatios_colMedians\",\"proteins_MedianOfRatios_medianPolish\",\"proteins_MedianCentering_robustSummary\",\"proteins_MedianCentering_colMedians\",\"proteins_MedianCentering_medianPolish\"],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\"],\"error_y\":{\"color\":\"rgba(255,127,14,1)\"},\"error_x\":{\"color\":\"rgba(255,127,14,1)\"},\"line\":{\"color\":\"rgba(255,127,14,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,-9.5,-8.5,-7.5,-6.5,-5.5,-4.5,-3.5,-2.5,-1.5,-0.5,0.5,1.5,2.5,3.5,4.5,5.5,6.5,7.5,8.5,9.5,0,-1.5,1.5,-2.5,-1.5,-0.5,0.5,1.5,2.5],\"y\":[3.7650000000000001,3.9649999999999999,4.165,3.8650000000000002,4.0650000000000004,4.2649999999999997,3.7650000000000001,3.9649999999999999,4.165,3.8650000000000002,4.0650000000000004,4.2649999999999997,3.7650000000000001,3.9649999999999999,4.165,3.8650000000000002,4.0650000000000004,4.2649999999999997,3.7650000000000001,3.9649999999999999,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,3.165,2.8650000000000002,3.0649999999999999,3.2650000000000001,2.7650000000000001,2.9649999999999999,2,0.90000000000000002,1.1000000000000001,-0.24999999999999997,-0.049999999999999989,0.15000000000000002,-0.14999999999999997,0.050000000000000044,0.25],\"text\":[\"B03_02_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_03_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_04_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_05_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_06_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_07_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_08_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_09_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_10_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_11_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_12_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_13_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_14_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_15_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_16_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_17_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_18_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_19_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_20_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_21_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B\",\"B03_02_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_03_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_04_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_05_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_06_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_07_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_08_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_09_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_10_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_11_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_12_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_13_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_14_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_15_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_16_150304_human_ecoli_E_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_17_150304_human_ecoli_D_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_18_150304_human_ecoli_C_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_19_150304_human_ecoli_B_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_20_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"B03_21_150304_human_ecoli_A_3ul_3um_column_95_HCD_OT_2hrs_30B_9B_log\",\"ions_log\",\"ions_norm_MedianOfRatios\",\"ions_norm_MedianCentering\",\"proteins_MedianOfRatios_robustSummary\",\"proteins_MedianOfRatios_colMedians\",\"proteins_MedianOfRatios_medianPolish\",\"proteins_MedianCentering_robustSummary\",\"proteins_MedianCentering_colMedians\",\"proteins_MedianCentering_medianPolish\"],\"type\":\"scatter\",\"mode\":\"text\",\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\"],\"marker\":{\"color\":\"rgba(44,160,44,1)\",\"line\":{\"color\":\"rgba(44,160,44,1)\"}},\"error_y\":{\"color\":\"rgba(44,160,44,1)\"},\"error_x\":{\"color\":\"rgba(44,160,44,1)\"},\"line\":{\"color\":\"rgba(44,160,44,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n\n \n:::\n:::\n\n\n## Data modelling\n\nThe preprocessed data for all 6 workflows^[There are 2 normalisaion\nmethods * 3 summarisation methods.] can now be modelled to assess our\nresearch hypothesis using the same approach, as described in the\n[basics chapter](#sec-modelling)^[Note that while we changed the\npreprocessing workflow, the sources of variation and the model to\nestimate remain the same as in @sec-basics.]. Remember,\nthe central research question is to \"prioritise proteins that have\nbeen spiked in across the conditions.\" Since we know the ground truth,\nwe can assess how accurately the model estimates the fold changes\nbetween spike-in conditions, and hence which preprocessing workflow\nleads to the best results.\n\nWe loop over the different assays to fit the model for the different\npreprocessed sets^[Those sets that start with `proteins_`.]. Recall\nthat the model estimation results are stored in the `rowData` of each\nset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nproteinSets <- grep(\"proteins_\", names(spikein), value = TRUE)\nfor (i in proteinSets) {\n  spikein <- msqrob(\n    spikein,  i = i, formula = ~ Condition, ridge = TRUE, robust = TRUE\n  )\n}\n```\n:::\n\n\nWe enable [M-estimation](#sec-robust) (`robust = TRUE`) for improved\nrobustness against outliers and [ridge regression](#sec-ridge) (`ridge\n= TRUE`) to stabilise parameter estimates. While the stabilising\neffects of ridge regression are most pronounced in complex models with\nmany parameters, we enable it here to ensure robust parameter\nestimation and for consistency with more advanced workflows.\n\nWe can create our [contrasts of interest](#sec-inference) and perform\n[hypothesis testing](#sec-hypothesis_testing).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nallContrasts <- createPairwiseContrasts(\n    ~ Condition, colData(spikein), var = \"Condition\", ridge = TRUE\n)\nL <- makeContrast(\n    allContrasts, \n    c(\"ridgeConditionB\", \"ridgeConditionC\", \"ridgeConditionD\", \"ridgeConditionE\")\n)\ninferences <- lapply(proteinSets, function(i) {\n  spikein <- hypothesisTest(spikein, i, contrast = L)\n  inference <- msqrobCollect(spikein[[i]], L)\n  inference$method <- i\n  inference\n})\ninferences <- do.call(rbind, inferences)\n```\n:::\n\n\nWe also add the information whether a protein is differentially\nabundant or not, since all E. Coli proteins are known to be spiked in\ndifferent concentrations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninferences <- mutate(\n  inferences,\n  isEcoli = feature %in% ecoli,\n  normalisation = sub(\"(.*)_(.*)_(.*)\", \"\\\\2\", method),\n  summarisation = sub(\"(.*)_(.*)_(.*)\", \"\\\\3\", method),\n  contrast = gsub(\"ridgeCondition\", \"\", contrast),\n  contrast = gsub(\"^([B-E])$\", \"\\\\1 - A\", contrast),\n)\n```\n:::\n\n\n\n## Performance Evaluation\n\nSince we have ground truth information (i.e., we know which proteins\nare from E. coli and should be differentially abundant), we can\nobjectively evaluate the performance of each workflow. Similarly to\nthe [previous chapter](#sec-performance), we will assess the number of\ntrue positives (TP, that are correctly identified E. coli proteins)\nand false positives (FP, that are human proteins incorrectly\nidentified as significant), the false discovery proportion (FDP), the\naccuracy of the estimated log2 fold changes (LFC), and finally, the\noverall performance using True Positive Rate (TPR) versus False\nDiscovery Proportion (FDP) curves.\n\nBefore delving into the performance plot, we will first create a\ncolour scheme in order to compare the different workflows. We will\nassign a colour to each combination of normalisation and summarisation\nmethod.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninferences <- mutate(\n  inferences,\n  workflow = paste0(normalisation, \"_\", summarisation)\n)\ncolours <- c(\n  MedianCentering_colMedians = \"#fcba03\",\n  MedianCentering_medianPolish = \"#c29310\",\n  MedianCentering_robustSummary = \"#423512\",\n  MedianOfRatios_colMedians = \"#5bb4fc\",\n  MedianOfRatios_medianPolish = \"#0b69b5\",\n  MedianOfRatios_robustSummary = \"#0f2a40\"\n)\n```\n:::\n\n\n\n### TP and FP at 5% FDR\n\nWe will first construct the table with TPs and FPs obtained\nfrom each data modelling approach for each comparison.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntpFpTable <- group_by(inferences, normalisation, workflow, contrast) |>\n    filter(adjPval < 0.05) |>\n    summarise(\"True Positives\" = sum(isEcoli),\n              \"False Positives\" = sum(!isEcoli),\n              FDP = mean(!isEcoli)) |>\n    pivot_longer(cols = c(\"True Positives\", \"False Positives\"),\n                 names_to = \"metric\", values_to = \"count\")\n```\n:::\n\n\nWe then plot the table as a bar plot, facetting for every comparison. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(tpFpTable) +\n  aes(\n    x = normalisation, y = count,\n    fill = workflow\n  ) +\n  geom_bar(\n    stat = \"identity\", position = position_dodge(preserve = \"single\"),\n    color = \"black\"\n  ) +\n  facet_grid(contrast ~ metric, scales = \"free\") +\n  scale_fill_manual(values = colours) +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1))\n```\n\n::: {.cell-output-display}\n![ ](04-workflow_optimisation_files/figure-html/wf_tp_fp-1.png){width=576}\n:::\n:::\n\n\nWe see that, while it has minimal impact on the TPs, the median centering normalisation approach increases the number of FPs for some comparisons (E-A and E-B). We therefore suggest to use the Median of ratio's normalisation method.  \n\nMore importantly, we see that summarising using the column median leads to poor performance (irrespective of the normalisation method used) as these workflow identify less TPs.\nThis can be easily explained as the summarisation step in this workflow does not account for the fact that different PSMs are often observed for a protein in the different samples and that their corresponding intensities largely fluctuate according to the differences in the PSM characteristics. \nThe median polish and the robust summary summarisation show similar performance.\nNote, however, that median polish is computationally less demanding. \n\n\n### TPR-FDP curves\n\nWe generate the [TPR-FDP curves](#sec-tpr_fdp) to assess the\nperformance of the different workflows to prioritise differentially\nabundant proteins. Again, these curves are built using the ground\ntruth information about which proteins are differentially abundant\n(spiked in) and which proteins are constant across samples. We create\ntwo functions to compute the TPR and the FDP.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncomputeFDP <- function(pval, tp) {\n    ord <- order(pval)\n    fdp <- cumsum(!tp[ord]) / 1:length(tp)\n    fdp[order(ord)]\n}\ncomputeTPR <- function(pval, tp, nTP = NULL) {\n    if (is.null(nTP)) nTP <- sum(tp)\n    ord <- order(pval)\n    tpr <- cumsum(tp[ord]) / nTP\n    tpr[order(ord)]\n}\n```\n:::\n\n\nWe apply these functions and compute the corresponding metric using the\nstatistical inference results and the ground truth information.\n\n\n::: {.cell}\n\n:::\n\n\nWe also highlight the observed FDP at a 5\\% FDR threshold.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nworkPoints <- group_by(performance, summarisation, normalisation, contrast) |>\n    filter(adjPval < 0.05) |>\n    slice_max(adjPval)\n```\n:::\n\n\nWe can now generate the plot^[Note that the code to build the TPR-FDP\ncurves is identical to the workflow in the previous chapter on data\nbenchmarking.].\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(performance) +\n    aes(\n        y = fdp,\n        x = tpr,\n        colour = workflow\n    ) +\n    geom_line() +\n    geom_point(data = workPoints, size = 3) +\n    geom_hline(yintercept = 0.05, linetype = 2) +\n    facet_grid(contrast ~ .) +\n    coord_flip(ylim = c(0, 0.2)) +\n    scale_colour_manual(values = colours)\n```\n\n::: {.cell-output-display}\n![ ](04-workflow_optimisation_files/figure-html/wf_fdr_fdp-1.png){width=480}\n:::\n:::\n\n\nAgain,  we also observe a benefit of the MedianOfRatios normalisation, which seems to improve the FDR control accross the board^[the dots indicating the sensitivity and FDP when using a 5% FDR cut-off are much closer to the empirical 5% FDP] as well as the sensitivity in contrasts involving the higher spike-in conditions. \n\nTPR-FDP curves also clearly indicate a suboptimal performance (lower sensitivity at the same false discovery proportion) of median summarisation.\n\n### Fold change boxplots\n\nFinally, we estimate the accuracy and precision of the log2-fold changes using [boxplots](#sec-benchmark_with_boxplots). We first create a table with the ground truth information from the spike-in experiment.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealLogFC <- data.frame(\n  expectedLogFC = t(L) %*% lm(log2(Concentration) ~ Condition, colData(spikein))$coef[-1]\n)\nrealLogFC$contrast <- gsub(\"ridgeCondition\",\"\",colnames(L))\nrealLogFC$contrast <- gsub(\"^([B-E])$\", \"\\\\1 - A\", realLogFC$contrast)\n```\n:::\n\n\nWe now plot the estimated log2-fold changes, focusing on the differentially abundant proteins (E. Coli proteins). The dashed line represents the true log2-fold change for each comparison. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nfilter(inferences, isEcoli) |> \n  ggplot() +\n  aes(\n      y = logFC,\n      x = normalisation,\n      colour = workflow\n  ) +\n  geom_boxplot()  +\n  facet_grid(contrast ~ ., scales = \"free\") +\n  geom_hline(data = realLogFC, aes(yintercept = expectedLogFC), \n             linetype = \"dashed\") +\n  scale_colour_manual(values = colours) +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1))\n```\n\n::: {.cell-output-display}\n![ ](04-workflow_optimisation_files/figure-html/wf_boxplot-1.png){width=480}\n:::\n:::\n\n\nThe plots show that median summarisation produces biased fold change estimates, again because it does not account for the differences in the characteristics of the PSMs that are observed in the different samples. \n\n## Conclusion\n\nIn this chapter, we objectively compared different normalisation and\nsummarisation strategies using a spike-in dataset with known ground\ntruth.\n\n1.  **Normalisation is critical**: The performance evaluation clearly\nshows that the choice of normalisation method has a significant impact\non the results. Workflows using the median-of-ratios normalisation\nconsistently outperformed those using simple median centering. They\nyielded more true positives, better control of the false discovery\nproportion, and more accurate log2-fold change estimates, particularly\nfor smaller fold changes.\n\n2. **Column median summarisation is suboptimal**: we found that \nsummarising peptide data to protein intensities using the column\n(sample) median leads to reduced sensitivity (low True Positive Rate)\nand specificity (low False Discovery Proportion), but also to lower\naccuracy (i.e. the estimated log2-fold changes are further from the\ntrue value on average) and precision (the estimations are more spread\naround the average estimation).\n\n3. **Median polish and robust summary provide comparable performance**:\nthe TPR-FDP curves show that the pipelines incorporating robust\nsummarisation and median polish are consistently closer to the ideal\ntop-left corner, with only subtle differences between the two\napproaches. This indicates that explicitly modelling peptide-specific\neffects and down-weighting outliers leads to more reliable\nprotein-level quantification and inference. Note that median polish\nsummarisation is computationally less demanding and that \nwe could not find a benefit in performance for robust summarisation that justifies its additional computational overhead.\n\nBased on this comprehensive evaluation, the recommended pipeline for\nthis type of dataset is the **median-of-ratios normalisation**\nfollowed by **median polish summarisation**. This combination provided\nthe best performance in terms of computational complexity, accuracy, sensitivity and FDR control, demonstrating the strength of\n`msqrob2` in identifying truly differentially abundant proteins while\ncontrolling for false discoveries.\n\n**TODO** discuss that data analysis optimisation is data set \ndependent, and other conclusion may be reached on other datasets?",
    "supporting": [
      "04-workflow_optimisation_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"site_libs/plotly-binding-4.11.0/plotly.js\"></script>\n<script src=\"site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"site_libs/crosstalk-1.2.2/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/crosstalk-1.2.2/js/crosstalk.min.js\"></script>\n<link href=\"site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}