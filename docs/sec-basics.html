<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 2 Statistical analysis with msqrob2 | Statistical analysis of mass spectrometry-based proteomics data" />
<meta property="og:type" content="book" />




<meta name="author" content="Christophe Vanderaa, Stijn Vandenbulcke, Lieven Clement" />

<meta name="date" content="2025-11-12" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="Chapter 2 Statistical analysis with msqrob2 | Statistical analysis of mass spectrometry-based proteomics data">

<title>Chapter 2 Statistical analysis with msqrob2 | Statistical analysis of mass spectrometry-based proteomics data</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css-0/msmb.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script>
function copy_link(id) {
  var dummy = document.createElement('input'),
  text = window.location.href.split(/[?#]/)[0] + '#' + id;
  document.body.appendChild(dummy);
  dummy.value = text;
  dummy.select();
  document.execCommand('copy');
  document.body.removeChild(dummy);
  
  var tooltip = document.getElementById(id + '-tooltip');
  tooltip.innerHTML = 'Copied!';
}

function reset_tooltip(id) {
  var tooltip = document.getElementById(id);
  tooltip.innerHTML = 'Copy link';
}
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }

code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Statistical analysis of mass spectrometry-based proteomics data<p><p class="author">Christophe Vanderaa, Stijn Vandenbulcke, Lieven Clement</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html" id="toc-preamble"><span class="toc-section-number">1</span> Preamble</a>
<a id="active-page" href="sec-basics.html" id="toc-sec-basics"><span class="toc-section-number">2</span> Statistical analysis with msqrob2</a><ul class="toc-sections">
<li class="toc"><a href="#background"> Background</a></li>
<li class="toc"><a href="#software"> Software</a></li>
<li class="toc"><a href="#NA"> Data</a></li>
<li class="toc"><a href="#NA"> Data preprocessing</a></li>
<li class="toc"><a href="#NA"> Data exploration</a></li>
<li class="toc"><a href="#sec-modelling"> Data modelling</a></li>
<li class="toc"><a href="#sec-inference"> Statistical inference</a></li>
<li class="toc"><a href="#going-further"> Going further</a></li>
<li class="toc"><a href="#conclusion"> Conclusion</a></li>
</ul>
<a href="sec-advanced.html" id="toc-sec-advanced"><span class="toc-section-number">3</span> Advanced statistical analysis with msqrob2</a>
<a href="sec-benchmarking.html" id="toc-sec-benchmarking"><span class="toc-section-number">4</span> Benchmarking workflows</a>
<a href="sec-francisella.html" id="toc-sec-francisella"><span class="toc-section-number">5</span> The francisella use case: a MaxQuant LFQ DDA dataset with technical replication</a>
<a href="sec-heart.html" id="toc-sec-heart"><span class="toc-section-number">6</span> Heart use case: a MaxQuant LFQ DDA dataset with a more complex design</a>
<a href="sec-mouse_diet.html#sec-mouse_diet" id="toc-sec-mouse_diet"><span class="toc-section-number">7</span> The mouse diet use case: a Skyline TMT DDA dataset</a>
<a href="sec-end.html" id="toc-sec-end"><span class="toc-section-number">8</span> Usefull links and session information</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="sec-basics" class="section level1" number="2">
<h1>
<span class="header-section-number">Chapter 2</span> Statistical analysis with msqrob2</h1>
<p>This chapter explains the main concepts for statistical analysis of
proteomics data using <code>msqrob2</code>. To illustrate these concepts, we will
use using a publicly available spike-in study (PRIDE identifier:
PXD003881 Shen et al. [2018]). This is an excellent example dataset
since it contains ground truth information about which proteins are
differentially abundant, enabling us to objectively demonstrate the
performance of <code>msqrob2</code>. This dataset has a relatively simple
experimental design (which does not imply that the analysis is easy),
allowing us to assess differential abundance using a data analysis
workflow with a single factor for the spike-in condition. For a more
advanced analysis with a more complex expiremental design, we refer to
our <a href="sec-advanced.html#sec-advanced">advanced concepts chapter</a></p>
<div id="background" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Background<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('background')" onmouseout="reset_tooltip('background-tooltip')"><span class="tooltiptext" id="background-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Mass spectrometry (MS)-based proteomics aims at characterising the
proteome abundance of biological samples. The most popular approach is
label-free quantification (LFQ), where every sample is analysed in a
separate MS run. This section provides an overview of the analytical
workflow and its main challenges regarding data modelling.</p>
<div id="sec-lfq_workflow" class="section level3" number="2.1.1">
<h3>
<span class="header-section-number">2.1.1</span> LFQ workflow<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-lfq_workflow')" onmouseout="reset_tooltip('sec-lfq_workflow-tooltip')"><span class="tooltiptext" id="sec-lfq_workflow-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>In a nutshell, the wetlab workflow starts with sample preparation where the
samples are collected, and the protein content is extracted and
digested into peptides. To reduce the sample complexity, the peptides
are then separated based on physicochemical properties (mostly
hydrophobicity) using liquid chromatography (LC). Peptides are
then ionised by an electrospray as they elute from the chromatographic
column. The signal over time generated by the eluting ions is called
the total ion chromatogram. The ions are then sent for a first round
of MS to record their m/z distribution for the intact ions. This
provides an overview of the ions that elute from the column and allows
for further separation of the ions in the m/z space. The second round
of MS (MS2) records the fragmented ions for a selection of ions,
generally the most intense MS1 peaks<label for="tufte-sn-1" class="margin-toggle sidenote-number">1</label><input type="checkbox" id="tufte-sn-1" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">1</span> The ion selection for MS2
depends on the data recorded in MS1. Therefore, this approach is
referred to as data dependent acquisition (DDA).</span>. This process is
repeated for every sample so that every sample is acquired in one MS
run. This provides the ion’s mass fingerprint. For LFQ workflows, the
accumulated MS1 intensity over time, also known as the area under the
curve, around the target mass is used as a quantitification measure.
On the other hand, the ion mass fingerprint, called the MS2 spectrum,
enables computational identification of the corresponding peptide
using search engines (e.g. Andromeda has been used for this data set)
that will provide peptide-to-spectrum matches (PSM). The quantified
PSM are further processed by the software (MaxQuant) to obtain a
peptide table<label for="tufte-sn-2" class="margin-toggle sidenote-number">2</label><input type="checkbox" id="tufte-sn-2" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">2</span> MaxQuant also computes a protein table. However, we
found that starting from MaxQuant’s protein table leads to a decrease
in performance. We will illustrate in this tutorial how to build the
protein table.</span>, where every row corresponds to an identified peptide
and every column contains information about the peptide and its
quantification in one of the samples.</p>
<div class="figure">
<img src="figs/lfq_workflow.png" alt="Overview of an LFQ-based proteomics workflow." width="40%"><p class="caption marginnote shownote">
Overview of an LFQ-based proteomics workflow.
</p>
</div>
</div>
<div id="sec-lfq_challenges" class="section level3" number="2.1.2">
<h3>
<span class="header-section-number">2.1.2</span> Challenges<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-lfq_challenges')" onmouseout="reset_tooltip('sec-lfq_challenges-tooltip')"><span class="tooltiptext" id="sec-lfq_challenges-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>Behind this workflow lies several challenges that will affect the data
modelling:</p>
<ul>
<li>MS-based proteomics doesn’t measure proteins directly, but their
constituting <strong>peptide ions</strong>. The protein-level information needs
to be reconstructed from the ion data. In this tutorial, we will
start from the peptide data, which has been constructed from the ion
data by MaxQuant.</li>
<li>All peptides cannot be ionised with the same efficiency. Poor
ionisation will lead to reduced signal as less ions will hit the
detector, hence leading to a huge variability in intensity among
different peptide species, even when they originate from the same
protein.</li>
<li>The identification step is not trivial and prone to
errors<label for="tufte-sn-3" class="margin-toggle sidenote-number">3</label><input type="checkbox" id="tufte-sn-3" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">3</span> Improving peptide identification is outside the scope of
this tutorial</span>. PSM misidentification leads to the assignment of a
quantitative values from another peptide with likely another
ionisation efficiency and relative abundance. Hence this misassigned
value will become an outlier.</li>
<li>Moreover, the ion selection for MS2 depends on its
intensity<label for="tufte-sn-4" class="margin-toggle sidenote-number">4</label><input type="checkbox" id="tufte-sn-4" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">4</span> Recall that only the top most intense ion peaks are send
for MS2</span>. Therefore, the chance to measure and, subsequently,
identify a peptide will depend on its abundance. Non identified
peptides will lead to data missingness, which is related to the
underlying quantification value. This phenomenon is known as
missingness not at random. Next to that, many reasons can lead to
ions not being selected or identified irrespective of their
quantification value leading to missingness that is not related to
its quantitative value. This is referred to as missingness
completely at random. The missingness issue is not negligible: only
41% of all proteins are quantified across all samples, and the
number drops to 6.6% when considering peptides.</li>
<li>The identification issues lead to unbalanced peptide missingness
across samples, and the patterns of missing values are potentially
different for every peptide, highlighting the need for an
automatised solution that is robust against missing values.</li>
<li>Technical variations during the experiment can lead to systematic
fluctuations across samples. The most obvious reason is when
different sample amounts are injected into the instruments, due to
small pipetting inconsistencies for instance. However, these
differences lead to unwanted variation that should be discarded when
answering biological questions.</li>
</ul>
</div>
<div id="sec-ecoli_experiment" class="section level3" number="2.1.3">
<h3>
<span class="header-section-number">2.1.3</span> Experimental context<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-ecoli_experiment')" onmouseout="reset_tooltip('sec-ecoli_experiment-tooltip')"><span class="tooltiptext" id="sec-ecoli_experiment-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>The samples were synthetically constructed, starting from a
trypsin-digested human background, hence human proteins are known to
be constant across samples E. coli lysates were spiked at five
different concentrations (3%, 4.5%, 6%, 7.5% and 9% wt/wt). So the E.
coli proteins are known to be differentially abundant, and we know
exactly in what amount they differ. There are four replicates per
spike-in condition. The samples were run on an Orbitrap Fusion mass
spectrometer. Raw data files were processed with MaxQuant (version
1.6.1.0) using default search settings unless otherwise noted. Spectra
were searched against the UniProtKB/SwissProt human and E. coli
reference proteome databases (07/06/2018), concatenated with the
default Maxquant contaminant database. Carbamidomethylation of Cystein
was set as a fixed modification, and oxidation of Methionine and
acetylation of the protein amino-terminus were allowed as variable
modifications. In silico cleavage was set to use trypsin/P, allowing
two miscleavages. Match between runs was also enabled using default
settings. The resulting peptide-to-spectrum matches (PSMs) were
filtered by MaxQuant at 1% FDR.</p>
<p>We will start from the peptide data generated by MaxQuant and infer
protein-level differences between samples. To achieve this goal, we
will apply an <code>msqrob2</code> workflow, a data processing and modelling
workflow dedicated to the analysis of MS-based proteomics datasets. We
will demonstrate how the workflow can retrieve the spiked-in proteins
from the E. coli data set, along with explanation of the key
statistical concepts behind proteomics data analysis. Before delving
into the analysis, we first set the concentrations for the different
spike-ins, and will prepare our computational environment.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="sec-basics.html#cb2-1" tabindex="-1"></a>concentrations <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">*</span> <span class="fl">1.5</span></span>
<span id="cb2-2"><a href="sec-basics.html#cb2-2" tabindex="-1"></a><span class="fu">names</span>(concentrations) <span class="ot">&lt;-</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
</div>
</div>
<div id="software" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Software<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('software')" onmouseout="reset_tooltip('software-tooltip')"><span class="tooltiptext" id="software-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<div id="load-packages" class="section level3" number="2.2.1">
<h3>
<span class="header-section-number">2.2.1</span> Load packages<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('load-packages')" onmouseout="reset_tooltip('load-packages-tooltip')"><span class="tooltiptext" id="load-packages-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>We load the <code>msqrob2</code> package, along with additional packages for
data manipulation and visualisation.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="sec-basics.html#cb3-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"msqrob2"</span>)</span>
<span id="cb3-2"><a href="sec-basics.html#cb3-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb3-3"><a href="sec-basics.html#cb3-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb3-4"><a href="sec-basics.html#cb3-4" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"patchwork"</span>)</span></code></pre></div>
</div>
<div id="sec-parallel" class="section level3" number="2.2.2">
<h3>
<span class="header-section-number">2.2.2</span> Parallelisation<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-parallel')" onmouseout="reset_tooltip('sec-parallel-tooltip')"><span class="tooltiptext" id="sec-parallel-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p><code>msqrob2</code> can parallelise computations during the model estimation
to improve speed. However, we will disable parallelisation to ensure
this vignette can be run regardless of hardware. Parallelisation is
controlled using the <code>BiocParallel</code> package.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="sec-basics.html#cb4-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"BiocParallel"</span>)</span>
<span id="cb4-2"><a href="sec-basics.html#cb4-2" tabindex="-1"></a><span class="fu">register</span>(<span class="fu">SerialParam</span>())</span></code></pre></div>
<p>If you want to use <code>msqrob2</code> with parallelisation enabled and using
4 cores, you can run the following:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="sec-basics.html#cb5-1" tabindex="-1"></a><span class="fu">register</span>(<span class="fu">MulticoreParam</span>(<span class="at">workers =</span> <span class="dv">4</span>))</span></code></pre></div>
<p>Be mindful that, while parallelisation can improve speed, it will also
consume more RAM because part of the data will be copied multiple
times over your different workers. If you experience crashes because
you exceeded the amount of available RAM on your machine, you should
reduce the number of requested workers.</p>
</div>
</div>
<div id="sec-ecoli_data" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Data<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-ecoli_data')" onmouseout="reset_tooltip('sec-ecoli_data-tooltip')"><span class="tooltiptext" id="sec-ecoli_data-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>The data were reanalysed by <span class="citation">Sticker et al. (<label for="tufte-mn-4" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-4" class="margin-toggle">2020<span class="marginnote">Sticker, Adriaan, Ludger Goeminne, Lennart Martens, and Lieven Clement. 2020. <span>“Robust Summarization and Inference in Proteome-Wide Label-Free Quantification.”</span> <em>Mol. Cell. Proteomics</em> 19 (7): 1209–19.</span>)</span> using MaxQuant and
deposited on <code>GitHub</code>. We here retrieve MaxQuant’s <code>peptides.txt</code> for the
E. coli study.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="sec-basics.html#cb6-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"BiocFileCache"</span>)</span>
<span id="cb6-2"><a href="sec-basics.html#cb6-2" tabindex="-1"></a>bfc <span class="ot">&lt;-</span> <span class="fu">BiocFileCache</span>()</span>
<span id="cb6-3"><a href="sec-basics.html#cb6-3" tabindex="-1"></a><span class="co"># myurl &lt;- "https://github.com/statOmics/MSqRobSumPaper/raw/refs/heads/master/spikein/data/maxquant/peptides.zip"</span></span>
<span id="cb6-4"><a href="sec-basics.html#cb6-4" tabindex="-1"></a><span class="co"># download.file(myurl,"data/sticker2020/peptides.zip", method = "curl", extra = "-L")</span></span>
<span id="cb6-5"><a href="sec-basics.html#cb6-5" tabindex="-1"></a><span class="co"># unzip("data/sticker2020/peptides.zip", exdir = "data/sticker2020/")</span></span>
<span id="cb6-6"><a href="sec-basics.html#cb6-6" tabindex="-1"></a>peptideFile <span class="ot">&lt;-</span> <span class="st">"data/sticker2020/peptides.txt"</span></span></code></pre></div>
<p><strong>TODO</strong>: put data on Zenodo. BiocFileCache will be used for fetching
these data.</p>
<div id="sec-peptide_table" class="section level4" number="2.3.0.1">
<h4>
<span class="header-section-number">2.3.0.1</span> Peptide table</h4>
<p>Each row in the peptide data table contains information about one
peptide (the table below shows the first 6 rows). The columns contains
various descriptors about the peptide, such as its sequence, its
charge, the amino acid composition, etc. Some of these columns (those
starting with <code>Intensity.</code>) contain the quantification values for each
sample. The table format where the quantitative values for each sample
are contained in a separate column is depicted as the “wide format”,
as opposed to the “long format” (eg, the <a href="sec-advanced.html#sec-psm_table">PSM table</a>).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="sec-basics.html#cb7-1" tabindex="-1"></a>peptides <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(peptideFile)</span>
<span id="cb7-2"><a href="sec-basics.html#cb7-2" tabindex="-1"></a>quantCols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"Intensity[.]"</span>, <span class="fu">names</span>(peptides), <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="1%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="6%">
<col width="6%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
</colgroup>
<thead><tr class="header">
<th align="left">Sequence</th>
<th align="left">N.term.cleavage.window</th>
<th align="left">C.term.cleavage.window</th>
<th align="left">Amino.acid.before</th>
<th align="left">First.amino.acid</th>
<th align="left">Second.amino.acid</th>
<th align="left">Second.last.amino.acid</th>
<th align="left">Last.amino.acid</th>
<th align="left">Amino.acid.after</th>
<th align="right">A.Count</th>
<th align="right">R.Count</th>
<th align="right">N.Count</th>
<th align="right">D.Count</th>
<th align="right">C.Count</th>
<th align="right">Q.Count</th>
<th align="right">E.Count</th>
<th align="right">G.Count</th>
<th align="right">H.Count</th>
<th align="right">I.Count</th>
<th align="right">L.Count</th>
<th align="right">K.Count</th>
<th align="right">M.Count</th>
<th align="right">F.Count</th>
<th align="right">P.Count</th>
<th align="right">S.Count</th>
<th align="right">T.Count</th>
<th align="right">W.Count</th>
<th align="right">Y.Count</th>
<th align="right">V.Count</th>
<th align="right">U.Count</th>
<th align="right">O.Count</th>
<th align="right">Length</th>
<th align="right">Missed.cleavages</th>
<th align="right">Mass</th>
<th align="left">Proteins</th>
<th align="left">Leading.razor.protein</th>
<th align="right">Start.position</th>
<th align="right">End.position</th>
<th align="left">Gene.names</th>
<th align="left">Protein.names</th>
<th align="left">Unique..Groups.</th>
<th align="left">Unique..Proteins.</th>
<th align="left">Charges</th>
<th align="right">PEP</th>
<th align="right">Score</th>
<th align="left">Identification.type.a1</th>
<th align="left">Identification.type.a2</th>
<th align="left">Identification.type.a3</th>
<th align="left">Identification.type.a4</th>
<th align="left">Identification.type.b1</th>
<th align="left">Identification.type.b2</th>
<th align="left">Identification.type.b3</th>
<th align="left">Identification.type.b4</th>
<th align="left">Identification.type.c1</th>
<th align="left">Identification.type.c2</th>
<th align="left">Identification.type.c3</th>
<th align="left">Identification.type.c4</th>
<th align="left">Identification.type.d1</th>
<th align="left">Identification.type.d2</th>
<th align="left">Identification.type.d3</th>
<th align="left">Identification.type.d4</th>
<th align="left">Identification.type.e1</th>
<th align="left">Identification.type.e2</th>
<th align="left">Identification.type.e3</th>
<th align="left">Identification.type.e4</th>
<th align="right">Experiment.a1</th>
<th align="right">Experiment.a2</th>
<th align="right">Experiment.a3</th>
<th align="right">Experiment.a4</th>
<th align="right">Experiment.b1</th>
<th align="right">Experiment.b2</th>
<th align="right">Experiment.b3</th>
<th align="right">Experiment.b4</th>
<th align="right">Experiment.c1</th>
<th align="right">Experiment.c2</th>
<th align="right">Experiment.c3</th>
<th align="right">Experiment.c4</th>
<th align="right">Experiment.d1</th>
<th align="right">Experiment.d2</th>
<th align="right">Experiment.d3</th>
<th align="right">Experiment.d4</th>
<th align="right">Experiment.e1</th>
<th align="right">Experiment.e2</th>
<th align="right">Experiment.e3</th>
<th align="right">Experiment.e4</th>
<th align="right">Intensity</th>
<th align="right">Intensity.a1</th>
<th align="right">Intensity.a2</th>
<th align="right">Intensity.a3</th>
<th align="right">Intensity.a4</th>
<th align="right">Intensity.b1</th>
<th align="right">Intensity.b2</th>
<th align="right">Intensity.b3</th>
<th align="right">Intensity.b4</th>
<th align="right">Intensity.c1</th>
<th align="right">Intensity.c2</th>
<th align="right">Intensity.c3</th>
<th align="right">Intensity.c4</th>
<th align="right">Intensity.d1</th>
<th align="right">Intensity.d2</th>
<th align="right">Intensity.d3</th>
<th align="right">Intensity.d4</th>
<th align="right">Intensity.e1</th>
<th align="right">Intensity.e2</th>
<th align="right">Intensity.e3</th>
<th align="right">Intensity.e4</th>
<th align="left">Reverse</th>
<th align="left">Potential.contaminant</th>
<th align="right">id</th>
<th align="left">Protein.group.IDs</th>
<th align="left">Mod..peptide.IDs</th>
<th align="left">Evidence.IDs</th>
<th align="left">MS.MS.IDs</th>
<th align="right">Best.MS.MS</th>
<th align="left">Oxidation..M..site.IDs</th>
<th align="right">MS.MS.Count</th>
<th align="right">LFQ.intensity.a1</th>
<th align="right">LFQ.intensity.a2</th>
<th align="right">LFQ.intensity.a3</th>
<th align="right">LFQ.intensity.a4</th>
<th align="right">LFQ.intensity.b1</th>
<th align="right">LFQ.intensity.b2</th>
<th align="right">LFQ.intensity.b3</th>
<th align="right">LFQ.intensity.b4</th>
<th align="right">LFQ.intensity.c1</th>
<th align="right">LFQ.intensity.c2</th>
<th align="right">LFQ.intensity.c3</th>
<th align="right">LFQ.intensity.c4</th>
<th align="right">LFQ.intensity.d1</th>
<th align="right">LFQ.intensity.d2</th>
<th align="right">LFQ.intensity.d3</th>
<th align="right">LFQ.intensity.d4</th>
<th align="right">LFQ.intensity.e1</th>
<th align="right">LFQ.intensity.e2</th>
<th align="right">LFQ.intensity.e3</th>
<th align="right">LFQ.intensity.e4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">AAAAAAAAAAAAAAAGAGAGAK</td>
<td align="left">QSRFQVDLVSENAGRAAAAAAAAAAAAAAA</td>
<td align="left">AAAAAAAAGAGAGAKQTPADGEASGESEPA</td>
<td align="left">R</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">K</td>
<td align="left">Q</td>
<td align="right">18</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">22</td>
<td align="right">0</td>
<td align="right">1595.8380</td>
<td align="left">P55011</td>
<td align="left">P55011</td>
<td align="right">93</td>
<td align="right">114</td>
<td align="left">SLC12A2</td>
<td align="left">Solute carrier family 12 member 2</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">2;3</td>
<td align="right">0.00e+00</td>
<td align="right">98.407</td>
<td align="left">By matching</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left"></td>
<td align="left">By MS/MS</td>
<td align="left"></td>
<td align="left">By matching</td>
<td align="left">By matching</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">By matching</td>
<td align="left"></td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">39754000</td>
<td align="right">6378300</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4268500</td>
<td align="right">7099400</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">8563700</td>
<td align="right">6597000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6846700</td>
<td align="right">0</td>
<td align="left"></td>
<td align="left"></td>
<td align="right">0</td>
<td align="left">2115</td>
<td align="left">0</td>
<td align="left">0;1;2;3;4;5;6;7</td>
<td align="left">0;1;2;3</td>
<td align="right">2</td>
<td align="left"></td>
<td align="right">2</td>
<td align="right">5715600</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4324900</td>
<td align="right">8047900</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">9420400</td>
<td align="right">5673000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5761500</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">AAAAAAAAAAGAAGGR</td>
<td align="left">______________________________</td>
<td align="left">AAAAAAAAAGAAGGRGSGPGRRRHLVPGAG</td>
<td align="left">M</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">G</td>
<td align="left">R</td>
<td align="left">G</td>
<td align="right">12</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">16</td>
<td align="right">0</td>
<td align="right">1197.6214</td>
<td align="left">Q86U42</td>
<td align="left">Q86U42</td>
<td align="right">2</td>
<td align="right">17</td>
<td align="left">PABPN1</td>
<td align="left">Polyadenylate-binding protein 2</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">2</td>
<td align="right">0.00e+00</td>
<td align="right">275.000</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By matching</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left"></td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By matching</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left"></td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1211200000</td>
<td align="right">76718000</td>
<td align="right">53670000</td>
<td align="right">86511000</td>
<td align="right">79070000</td>
<td align="right">57211000</td>
<td align="right">56593000</td>
<td align="right">81544000</td>
<td align="right">79032000</td>
<td align="right">0</td>
<td align="right">46087000</td>
<td align="right">62303000</td>
<td align="right">73292000</td>
<td align="right">60707000</td>
<td align="right">50560000</td>
<td align="right">75644000</td>
<td align="right">75246000</td>
<td align="right">52106000</td>
<td align="right">0</td>
<td align="right">74366000</td>
<td align="right">70540000</td>
<td align="left"></td>
<td align="left"></td>
<td align="right">1</td>
<td align="left">3262</td>
<td align="left">1</td>
<td align="left">8;9;10;11;12;13;14;15;16;17;18;19;20;21;22;23;24;25</td>
<td align="left">4;5;6;7;8;9;10;11;12;13;14;15;16;17;18;19</td>
<td align="right">9</td>
<td align="left"></td>
<td align="right">15</td>
<td align="right">68748000</td>
<td align="right">59998000</td>
<td align="right">74863000</td>
<td align="right">70216000</td>
<td align="right">57211000</td>
<td align="right">63173000</td>
<td align="right">69374000</td>
<td align="right">69165000</td>
<td align="right">0</td>
<td align="right">52244000</td>
<td align="right">66990000</td>
<td align="right">62028000</td>
<td align="right">62554000</td>
<td align="right">55618000</td>
<td align="right">65050000</td>
<td align="right">63171000</td>
<td align="right">55715000</td>
<td align="right">0</td>
<td align="right">62578000</td>
<td align="right">58656000</td>
</tr>
<tr class="odd">
<td align="left">AAAAAAALQAK</td>
<td align="left">TILRQARNHKLRVDKAAAAAAALQAKSDEK</td>
<td align="left">RVDKAAAAAAALQAKSDEKAAVAGKKPVVG</td>
<td align="left">K</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">K</td>
<td align="left">S</td>
<td align="right">8</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">11</td>
<td align="right">0</td>
<td align="right">955.5451</td>
<td align="left">P36578</td>
<td align="left">P36578</td>
<td align="right">354</td>
<td align="right">364</td>
<td align="left">RPL4</td>
<td align="left">60S ribosomal protein L4</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">2</td>
<td align="right">1.00e-07</td>
<td align="right">182.680</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">1829100000</td>
<td align="right">129520000</td>
<td align="right">56753000</td>
<td align="right">114890000</td>
<td align="right">126100000</td>
<td align="right">33394000</td>
<td align="right">66695000</td>
<td align="right">93968000</td>
<td align="right">125070000</td>
<td align="right">84220000</td>
<td align="right">83186000</td>
<td align="right">102980000</td>
<td align="right">108620000</td>
<td align="right">72544000</td>
<td align="right">76384000</td>
<td align="right">100270000</td>
<td align="right">118790000</td>
<td align="right">67553000</td>
<td align="right">52009000</td>
<td align="right">115880000</td>
<td align="right">100300000</td>
<td align="left"></td>
<td align="left"></td>
<td align="right">2</td>
<td align="left">1762</td>
<td align="left">2</td>
<td align="left">26;27;28;29;30;31;32;33;34;35;36;37;38;39;40;41;42;43;44;45;46;47;48;49;50;51;52;53;54;55;56;57;58;59;60;61;62;63;64;65;66;67;68;69;70;71;72;73;74;75;76</td>
<td align="left">20;21;22;23;24;25;26;27;28;29;30;31;32;33;34;35;36;37;38;39;40;41;42;43;44;45;46;47;48;49;50;51;52;53;54;55;56;57</td>
<td align="right">29</td>
<td align="left"></td>
<td align="right">30</td>
<td align="right">116060000</td>
<td align="right">63444000</td>
<td align="right">99420000</td>
<td align="right">111980000</td>
<td align="right">33394000</td>
<td align="right">74449000</td>
<td align="right">79944000</td>
<td align="right">109450000</td>
<td align="right">85332000</td>
<td align="right">94299000</td>
<td align="right">110730000</td>
<td align="right">91926000</td>
<td align="right">74751000</td>
<td align="right">84026000</td>
<td align="right">86223000</td>
<td align="right">99722000</td>
<td align="right">72233000</td>
<td align="right">56151000</td>
<td align="right">97516000</td>
<td align="right">83401000</td>
</tr>
<tr class="even">
<td align="left">AAAAAAGAASGLPGPVAQGLK</td>
<td align="left">______________________________</td>
<td align="left">GAASGLPGPVAQGLKEALVDTLTGILSPVQ</td>
<td align="left">M</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">L</td>
<td align="left">K</td>
<td align="left">E</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">21</td>
<td align="right">0</td>
<td align="right">1747.9581</td>
<td align="left">Q96P70</td>
<td align="left">Q96P70</td>
<td align="right">2</td>
<td align="right">22</td>
<td align="left">IPO9</td>
<td align="left">Importin-9</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">2;3</td>
<td align="right">0.00e+00</td>
<td align="right">202.440</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1789100000</td>
<td align="right">109030000</td>
<td align="right">72676000</td>
<td align="right">101320000</td>
<td align="right">97545000</td>
<td align="right">77269000</td>
<td align="right">79290000</td>
<td align="right">110840000</td>
<td align="right">110060000</td>
<td align="right">75937000</td>
<td align="right">74675000</td>
<td align="right">68192000</td>
<td align="right">102570000</td>
<td align="right">93726000</td>
<td align="right">72743000</td>
<td align="right">108550000</td>
<td align="right">98519000</td>
<td align="right">70725000</td>
<td align="right">80125000</td>
<td align="right">93910000</td>
<td align="right">91423000</td>
<td align="left"></td>
<td align="left"></td>
<td align="right">3</td>
<td align="left">3783</td>
<td align="left">3</td>
<td align="left">77;78;79;80;81;82;83;84;85;86;87;88;89;90;91;92;93;94;95;96;97;98;99;100;101;102;103;104;105;106;107;108;109;110;111;112;113;114;115;116</td>
<td align="left">58;59;60;61;62;63;64;65;66;67;68;69;70;71;72;73;74;75;76;77;78;79;80;81;82;83;84;85;86;87;88;89;90;91;92;93;94;95;96;97;98;99;100;101;102;103;104;105;106;107</td>
<td align="right">85</td>
<td align="left"></td>
<td align="right">50</td>
<td align="right">97706000</td>
<td align="right">81244000</td>
<td align="right">87682000</td>
<td align="right">86622000</td>
<td align="right">77269000</td>
<td align="right">88508000</td>
<td align="right">94294000</td>
<td align="right">96324000</td>
<td align="right">76939000</td>
<td align="right">84650000</td>
<td align="right">73322000</td>
<td align="right">86806000</td>
<td align="right">96578000</td>
<td align="right">80020000</td>
<td align="right">93344000</td>
<td align="right">82709000</td>
<td align="right">75624000</td>
<td align="right">86506000</td>
<td align="right">79024000</td>
<td align="right">76020000</td>
</tr>
<tr class="odd">
<td align="left">AAAAAAGAGPEMVR</td>
<td align="left">______________________________</td>
<td align="left">MAAAAAAGAGPEMVRGQVFDVGPRYTNLSY</td>
<td align="left">M</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">V</td>
<td align="left">R</td>
<td align="left">G</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">14</td>
<td align="right">0</td>
<td align="right">1241.6187</td>
<td align="left">P28482</td>
<td align="left">P28482</td>
<td align="right">2</td>
<td align="right">15</td>
<td align="left">MAPK1</td>
<td align="left">Mitogen-activated protein kinase 1</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">2</td>
<td align="right">0.00e+00</td>
<td align="right">168.740</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left"></td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left"></td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">72178000</td>
<td align="right">0</td>
<td align="right">29646000</td>
<td align="right">41064000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1468400</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left"></td>
<td align="left"></td>
<td align="right">4</td>
<td align="left">1600</td>
<td align="left">4</td>
<td align="left">117;118;119;120;121;122;123;124;125;126;127</td>
<td align="left">108;109;110;111;112;113;114;115;116;117</td>
<td align="right">109</td>
<td align="left"></td>
<td align="right">10</td>
<td align="right">0</td>
<td align="right">33141000</td>
<td align="right">35535000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1664500</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">AAAAAAGSGTPREEEGPAGEAAASQPQAPTSVPGAR</td>
<td align="left">______________________________</td>
<td align="left">AASQPQAPTSVPGARLSRLPLARVKALVKA</td>
<td align="left">M</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">R</td>
<td align="left">L</td>
<td align="right">12</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">36</td>
<td align="right">1</td>
<td align="right">3287.5767</td>
<td align="left">Q9NR33</td>
<td align="left">Q9NR33</td>
<td align="right">2</td>
<td align="right">37</td>
<td align="left">POLE4</td>
<td align="left">DNA polymerase epsilon subunit 4</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">3</td>
<td align="right">3.34e-05</td>
<td align="right">40.328</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">By MS/MS</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">6961000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6961000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left"></td>
<td align="left"></td>
<td align="right">5</td>
<td align="left">4289</td>
<td align="left">5</td>
<td align="left">128</td>
<td align="left">118</td>
<td align="right">118</td>
<td align="left"></td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5891200</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="sec-annotation_table" class="section level4" number="2.3.0.2">
<h4>
<span class="header-section-number">2.3.0.2</span> Sample annotation table</h4>
<p>Each row in the annotation table contains information about one
sample. The columns contain various descriptors about the sample, such
as the name of the sample or the MS run, the treatment (here the
spike-in condition), the lab that acquired the sample or any other
biological or technical information that may impact the data quality
or the quantification. Without an annotation table, no analysis
can be performed. The sample annotations are generated by the
researcher. In this example, the annotations are extracted from the
sample names, although reporting a detailed design of experiments in a
table is seen as better practice <span class="citation">(<label for="tufte-mn-5" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-5" class="margin-toggle">Gatto et al. 2023<span class="marginnote">Gatto, Laurent, Ruedi Aebersold, Juergen Cox, Vadim Demichev, Jason Derks, Edward Emmott, Alexander M Franks, et al. 2023. <span>“Initial Recommendations for Performing, Benchmarking and Reporting Single-Cell Proteomics Experiments.”</span> <em>Nat. Methods</em> 20 (3): 375–86.</span>)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="sec-basics.html#cb8-1" tabindex="-1"></a>coldata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">quantCols =</span> quantCols)</span>
<span id="cb8-2"><a href="sec-basics.html#cb8-2" tabindex="-1"></a>coldata<span class="sc">$</span>condition <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Intensity.(.)."</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, quantCols)</span>
<span id="cb8-3"><a href="sec-basics.html#cb8-3" tabindex="-1"></a>coldata<span class="sc">$</span>concentration <span class="ot">&lt;-</span> concentrations[coldata<span class="sc">$</span>condition]</span></code></pre></div>
<table>
<thead><tr class="header">
<th align="left">quantCols</th>
<th align="left">condition</th>
<th align="right">concentration</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Intensity.a1</td>
<td align="left">a</td>
<td align="right">3.0</td>
</tr>
<tr class="even">
<td align="left">Intensity.a2</td>
<td align="left">a</td>
<td align="right">3.0</td>
</tr>
<tr class="odd">
<td align="left">Intensity.a3</td>
<td align="left">a</td>
<td align="right">3.0</td>
</tr>
<tr class="even">
<td align="left">Intensity.a4</td>
<td align="left">a</td>
<td align="right">3.0</td>
</tr>
<tr class="odd">
<td align="left">Intensity.b1</td>
<td align="left">b</td>
<td align="right">4.5</td>
</tr>
<tr class="even">
<td align="left">Intensity.b2</td>
<td align="left">b</td>
<td align="right">4.5</td>
</tr>
</tbody>
</table>
<p>We will also extract the E. coli protein identifiers from the FASTA
file to later annotate the spike-in proteins which are known to be
differentially abundant.</p>
<ol style="list-style-type: decimal">
<li>We download the fasta files</li>
<li>We read the text file as vector, one line p</li>
<li>We keep only the protein headers</li>
<li>We extract the proteins identifiers from the headers</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="sec-basics.html#cb9-1" tabindex="-1"></a>ecoli <span class="ot">&lt;-</span> <span class="fu">bfcrpath</span>(bfc, <span class="st">"https://raw.githubusercontent.com/statOmics/MSqRobSumPaper/refs/heads/master/spikein/data/fasta/ecoli_up000000625_7_06_2018.fasta"</span>)</span>
<span id="cb9-2"><a href="sec-basics.html#cb9-2" tabindex="-1"></a>ecoli <span class="ot">&lt;-</span> <span class="fu">readLines</span>(ecoli)</span>
<span id="cb9-3"><a href="sec-basics.html#cb9-3" tabindex="-1"></a>ecoli <span class="ot">&lt;-</span> ecoli[<span class="fu">grepl</span>(<span class="st">"^&gt;"</span>, ecoli)]</span>
<span id="cb9-4"><a href="sec-basics.html#cb9-4" tabindex="-1"></a>ecoli <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"&gt;sp</span><span class="sc">\\</span><span class="st">|(.*)</span><span class="sc">\\</span><span class="st">|.*"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, ecoli)</span></code></pre></div>
</div>
<div id="sec-qfeatures" class="section level3" number="2.3.1">
<h3>
<span class="header-section-number">2.3.1</span> Convert to QFeatures<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-qfeatures')" onmouseout="reset_tooltip('sec-qfeatures-tooltip')"><span class="tooltiptext" id="sec-qfeatures-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p><code>msqrob2</code> is built around the <code>QFeatures</code> class. We refer to the <a href="https://rformassspectrometry.github.io/book/sec-quant.html">R
for mass spectrometry
book</a> for
a comprehensive description of the class. In a nutshell, the
<code>QFeatures</code> package provides infrastructure to manage and analyse
quantitative features from mass spectrometry experiments. It is based
on the <code>SummarizedExperiment</code> and <code>MultiAssayExperiment</code> classes. It
leverages the hierarchical structure of proteomics experiments: data
proteins are composed of peptides, themselves produced by spectra.
Each piece of information in stored in an individual
<code>SummarizedExperiment</code> object, later referred to as a “set”.
Throughout the aggregation and processing of these data, the relations
between sets are tracked and recorded, thus allowing users to easily
navigate across spectra, peptide and protein quantitative data.</p>
<div class="figure">
<img src="figs/QFeatures.png" alt="Illustration of the `QFeatures` data class." width="80%"><p class="caption marginnote shownote">
Illustration of the <code>QFeatures</code> data class.
</p>
</div>
<p>The <code>readQFeatures()</code> enables a seamless conversion of tabular data
into a <code>QFeatures</code> object. We provide the peptide table and the sample
annotation table. The function will use the <code>quantCols</code> column in the
sample annotation table to understand which columns in <code>peptides</code>
contain the quantitative values, and automatically link the
corresponding sample annotation with the quantitative values. We also
tell the function to use the <code>Sequence</code> column as peptide identifier,
which will be used as rownames. See <code>?readQFeatures()</code> for more
details.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="sec-basics.html#cb10-1" tabindex="-1"></a>(spikein <span class="ot">&lt;-</span> <span class="fu">readQFeatures</span>(</span>
<span id="cb10-2"><a href="sec-basics.html#cb10-2" tabindex="-1"></a>  peptides, coldata, <span class="at">name =</span> <span class="st">"peptides"</span>, <span class="at">fnames =</span> <span class="st">"Sequence"</span></span>
<span id="cb10-3"><a href="sec-basics.html#cb10-3" tabindex="-1"></a>))</span></code></pre></div>
<pre><code>## An instance of class QFeatures (type: bulk) with 1 set:
## 
##  [1] peptides: SummarizedExperiment with 32827 rows and 20 columns</code></pre>
<p>We now have a <code>QFeatures</code> object with 1 set, called <code>peptides</code> (which
we specified using the <code>name</code> argument). In this toy example, we have
information for 32827 peptides across 45 samples, as
expected (recall the <a href="sec-basics.html#sec-ecoli_experiment">experimental design</a>).</p>
<p>The sample annotations can be retrieved using <code>colData()</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="sec-basics.html#cb12-1" tabindex="-1"></a><span class="fu">colData</span>(spikein)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="sec-basics.html#cb13-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(<span class="fu">colData</span>(spikein)))</span></code></pre></div>
<table>
<thead><tr class="header">
<th align="left"></th>
<th align="left">quantCols</th>
<th align="left">condition</th>
<th align="right">concentration</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Intensity.a1</td>
<td align="left">Intensity.a1</td>
<td align="left">a</td>
<td align="right">3.0</td>
</tr>
<tr class="even">
<td align="left">Intensity.a2</td>
<td align="left">Intensity.a2</td>
<td align="left">a</td>
<td align="right">3.0</td>
</tr>
<tr class="odd">
<td align="left">Intensity.a3</td>
<td align="left">Intensity.a3</td>
<td align="left">a</td>
<td align="right">3.0</td>
</tr>
<tr class="even">
<td align="left">Intensity.a4</td>
<td align="left">Intensity.a4</td>
<td align="left">a</td>
<td align="right">3.0</td>
</tr>
<tr class="odd">
<td align="left">Intensity.b1</td>
<td align="left">Intensity.b1</td>
<td align="left">b</td>
<td align="right">4.5</td>
</tr>
<tr class="even">
<td align="left">Intensity.b2</td>
<td align="left">Intensity.b2</td>
<td align="left">b</td>
<td align="right">4.5</td>
</tr>
</tbody>
</table>
<p>We can get a sample annotation directly using the <code>$</code> accessor.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="sec-basics.html#cb14-1" tabindex="-1"></a><span class="fu">head</span>(spikein<span class="sc">$</span>concentration)</span></code></pre></div>
<pre><code>## [1] 3.0 3.0 3.0 3.0 4.5 4.5</code></pre>
<p>We can extract the <code>SummarizedExperiment</code> object for the <code>peptides</code>
set using double bracket subsetting<label for="tufte-sn-5" class="margin-toggle sidenote-number">5</label><input type="checkbox" id="tufte-sn-5" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">5</span> A <code>QFeatures</code> object can be seen
as a special list of <code>SummarizedExperiment</code> objects.</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="sec-basics.html#cb16-1" tabindex="-1"></a>spikein[[<span class="st">"peptides"</span>]]</span></code></pre></div>
<pre><code>## class: SummarizedExperiment 
## dim: 32827 20 
## metadata(0):
## assays(1): ''
## rownames(32827): AAAAAAAAAAAAAAAGAGAGAK AAAAAAAAAAGAAGGR ...
##   YYVTIIDAPGHRDFIK YYYIPQYK
## rowData names(116): Sequence N.term.cleavage.window ...
##   LFQ.intensity.e3 LFQ.intensity.e4
## colnames(20): Intensity.a1 Intensity.a2 ... Intensity.e3 Intensity.e4
## colData names(0):</code></pre>
<p>But notice that the sample annotations were not extracted along with
the SummarizedExperiment (<code>colData names(0):</code>). This can be performed
using <code>getWithColData()</code>, which extracts the set of interest (like
<code>[[]]</code>) along with all the associated sample annotations.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="sec-basics.html#cb18-1" tabindex="-1"></a><span class="fu">getWithColData</span>(spikein, <span class="st">"peptides"</span>)</span></code></pre></div>
<pre><code>## class: SummarizedExperiment 
## dim: 32827 20 
## metadata(0):
## assays(1): ''
## rownames(32827): AAAAAAAAAAAAAAAGAGAGAK AAAAAAAAAAGAAGGR ...
##   YYVTIIDAPGHRDFIK YYYIPQYK
## rowData names(116): Sequence N.term.cleavage.window ...
##   LFQ.intensity.e3 LFQ.intensity.e4
## colnames(20): Intensity.a1 Intensity.a2 ... Intensity.e3 Intensity.e4
## colData names(3): quantCols condition concentration</code></pre>
<p>The peptides annotations are available for in the corresponding
<code>rowData</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="sec-basics.html#cb20-1" tabindex="-1"></a><span class="fu">rowData</span>(spikein[[<span class="st">"peptides"</span>]])</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="sec-basics.html#cb21-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(<span class="fu">rowData</span>(spikein[[<span class="st">"peptides"</span>]])))</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="7%">
<col width="7%">
<col width="0%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Sequence</th>
<th align="left">N.term.cleavage.window</th>
<th align="left">C.term.cleavage.window</th>
<th align="left">Amino.acid.before</th>
<th align="left">First.amino.acid</th>
<th align="left">Second.amino.acid</th>
<th align="left">Second.last.amino.acid</th>
<th align="left">Last.amino.acid</th>
<th align="left">Amino.acid.after</th>
<th align="right">A.Count</th>
<th align="right">R.Count</th>
<th align="right">N.Count</th>
<th align="right">D.Count</th>
<th align="right">C.Count</th>
<th align="right">Q.Count</th>
<th align="right">E.Count</th>
<th align="right">G.Count</th>
<th align="right">H.Count</th>
<th align="right">I.Count</th>
<th align="right">L.Count</th>
<th align="right">K.Count</th>
<th align="right">M.Count</th>
<th align="right">F.Count</th>
<th align="right">P.Count</th>
<th align="right">S.Count</th>
<th align="right">T.Count</th>
<th align="right">W.Count</th>
<th align="right">Y.Count</th>
<th align="right">V.Count</th>
<th align="right">U.Count</th>
<th align="right">O.Count</th>
<th align="right">Length</th>
<th align="right">Missed.cleavages</th>
<th align="right">Mass</th>
<th align="left">Proteins</th>
<th align="left">Leading.razor.protein</th>
<th align="right">Start.position</th>
<th align="right">End.position</th>
<th align="left">Gene.names</th>
<th align="left">Protein.names</th>
<th align="left">Unique..Groups.</th>
<th align="left">Unique..Proteins.</th>
<th align="left">Charges</th>
<th align="right">PEP</th>
<th align="right">Score</th>
<th align="left">Identification.type.a1</th>
<th align="left">Identification.type.a2</th>
<th align="left">Identification.type.a3</th>
<th align="left">Identification.type.a4</th>
<th align="left">Identification.type.b1</th>
<th align="left">Identification.type.b2</th>
<th align="left">Identification.type.b3</th>
<th align="left">Identification.type.b4</th>
<th align="left">Identification.type.c1</th>
<th align="left">Identification.type.c2</th>
<th align="left">Identification.type.c3</th>
<th align="left">Identification.type.c4</th>
<th align="left">Identification.type.d1</th>
<th align="left">Identification.type.d2</th>
<th align="left">Identification.type.d3</th>
<th align="left">Identification.type.d4</th>
<th align="left">Identification.type.e1</th>
<th align="left">Identification.type.e2</th>
<th align="left">Identification.type.e3</th>
<th align="left">Identification.type.e4</th>
<th align="right">Experiment.a1</th>
<th align="right">Experiment.a2</th>
<th align="right">Experiment.a3</th>
<th align="right">Experiment.a4</th>
<th align="right">Experiment.b1</th>
<th align="right">Experiment.b2</th>
<th align="right">Experiment.b3</th>
<th align="right">Experiment.b4</th>
<th align="right">Experiment.c1</th>
<th align="right">Experiment.c2</th>
<th align="right">Experiment.c3</th>
<th align="right">Experiment.c4</th>
<th align="right">Experiment.d1</th>
<th align="right">Experiment.d2</th>
<th align="right">Experiment.d3</th>
<th align="right">Experiment.d4</th>
<th align="right">Experiment.e1</th>
<th align="right">Experiment.e2</th>
<th align="right">Experiment.e3</th>
<th align="right">Experiment.e4</th>
<th align="right">Intensity</th>
<th align="left">Reverse</th>
<th align="left">Potential.contaminant</th>
<th align="right">id</th>
<th align="left">Protein.group.IDs</th>
<th align="left">Mod..peptide.IDs</th>
<th align="left">Evidence.IDs</th>
<th align="left">MS.MS.IDs</th>
<th align="right">Best.MS.MS</th>
<th align="left">Oxidation..M..site.IDs</th>
<th align="right">MS.MS.Count</th>
<th align="right">LFQ.intensity.a1</th>
<th align="right">LFQ.intensity.a2</th>
<th align="right">LFQ.intensity.a3</th>
<th align="right">LFQ.intensity.a4</th>
<th align="right">LFQ.intensity.b1</th>
<th align="right">LFQ.intensity.b2</th>
<th align="right">LFQ.intensity.b3</th>
<th align="right">LFQ.intensity.b4</th>
<th align="right">LFQ.intensity.c1</th>
<th align="right">LFQ.intensity.c2</th>
<th align="right">LFQ.intensity.c3</th>
<th align="right">LFQ.intensity.c4</th>
<th align="right">LFQ.intensity.d1</th>
<th align="right">LFQ.intensity.d2</th>
<th align="right">LFQ.intensity.d3</th>
<th align="right">LFQ.intensity.d4</th>
<th align="right">LFQ.intensity.e1</th>
<th align="right">LFQ.intensity.e2</th>
<th align="right">LFQ.intensity.e3</th>
<th align="right">LFQ.intensity.e4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">AAAAAAAAAAAAAAAGAGAGAK</td>
<td align="left">AAAAAAAAAAAAAAAGAGAGAK</td>
<td align="left">QSRFQVDLVSENAGRAAAAAAAAAAAAAAA</td>
<td align="left">AAAAAAAAGAGAGAKQTPADGEASGESEPA</td>
<td align="left">R</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">K</td>
<td align="left">Q</td>
<td align="right">18</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">22</td>
<td align="right">0</td>
<td align="right">1595.8380</td>
<td align="left">P55011</td>
<td align="left">P55011</td>
<td align="right">93</td>
<td align="right">114</td>
<td align="left">SLC12A2</td>
<td align="left">Solute carrier family 12 member 2</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">2;3</td>
<td align="right">0.00e+00</td>
<td align="right">98.407</td>
<td align="left">By matching</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left"></td>
<td align="left">By MS/MS</td>
<td align="left"></td>
<td align="left">By matching</td>
<td align="left">By matching</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">By matching</td>
<td align="left"></td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">39754000</td>
<td align="left"></td>
<td align="left"></td>
<td align="right">0</td>
<td align="left">2115</td>
<td align="left">0</td>
<td align="left">0;1;2;3;4;5;6;7</td>
<td align="left">0;1;2;3</td>
<td align="right">2</td>
<td align="left"></td>
<td align="right">2</td>
<td align="right">5715600</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4324900</td>
<td align="right">8047900</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">9420400</td>
<td align="right">5673000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5761500</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">AAAAAAAAAAGAAGGR</td>
<td align="left">AAAAAAAAAAGAAGGR</td>
<td align="left">______________________________</td>
<td align="left">AAAAAAAAAGAAGGRGSGPGRRRHLVPGAG</td>
<td align="left">M</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">G</td>
<td align="left">R</td>
<td align="left">G</td>
<td align="right">12</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">16</td>
<td align="right">0</td>
<td align="right">1197.6214</td>
<td align="left">Q86U42</td>
<td align="left">Q86U42</td>
<td align="right">2</td>
<td align="right">17</td>
<td align="left">PABPN1</td>
<td align="left">Polyadenylate-binding protein 2</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">2</td>
<td align="right">0.00e+00</td>
<td align="right">275.000</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By matching</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left"></td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By matching</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left"></td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1211200000</td>
<td align="left"></td>
<td align="left"></td>
<td align="right">1</td>
<td align="left">3262</td>
<td align="left">1</td>
<td align="left">8;9;10;11;12;13;14;15;16;17;18;19;20;21;22;23;24;25</td>
<td align="left">4;5;6;7;8;9;10;11;12;13;14;15;16;17;18;19</td>
<td align="right">9</td>
<td align="left"></td>
<td align="right">15</td>
<td align="right">68748000</td>
<td align="right">59998000</td>
<td align="right">74863000</td>
<td align="right">70216000</td>
<td align="right">57211000</td>
<td align="right">63173000</td>
<td align="right">69374000</td>
<td align="right">69165000</td>
<td align="right">0</td>
<td align="right">52244000</td>
<td align="right">66990000</td>
<td align="right">62028000</td>
<td align="right">62554000</td>
<td align="right">55618000</td>
<td align="right">65050000</td>
<td align="right">63171000</td>
<td align="right">55715000</td>
<td align="right">0</td>
<td align="right">62578000</td>
<td align="right">58656000</td>
</tr>
<tr class="odd">
<td align="left">AAAAAAALQAK</td>
<td align="left">AAAAAAALQAK</td>
<td align="left">TILRQARNHKLRVDKAAAAAAALQAKSDEK</td>
<td align="left">RVDKAAAAAAALQAKSDEKAAVAGKKPVVG</td>
<td align="left">K</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">K</td>
<td align="left">S</td>
<td align="right">8</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">11</td>
<td align="right">0</td>
<td align="right">955.5451</td>
<td align="left">P36578</td>
<td align="left">P36578</td>
<td align="right">354</td>
<td align="right">364</td>
<td align="left">RPL4</td>
<td align="left">60S ribosomal protein L4</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">2</td>
<td align="right">1.00e-07</td>
<td align="right">182.680</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">1829100000</td>
<td align="left"></td>
<td align="left"></td>
<td align="right">2</td>
<td align="left">1762</td>
<td align="left">2</td>
<td align="left">26;27;28;29;30;31;32;33;34;35;36;37;38;39;40;41;42;43;44;45;46;47;48;49;50;51;52;53;54;55;56;57;58;59;60;61;62;63;64;65;66;67;68;69;70;71;72;73;74;75;76</td>
<td align="left">20;21;22;23;24;25;26;27;28;29;30;31;32;33;34;35;36;37;38;39;40;41;42;43;44;45;46;47;48;49;50;51;52;53;54;55;56;57</td>
<td align="right">29</td>
<td align="left"></td>
<td align="right">30</td>
<td align="right">116060000</td>
<td align="right">63444000</td>
<td align="right">99420000</td>
<td align="right">111980000</td>
<td align="right">33394000</td>
<td align="right">74449000</td>
<td align="right">79944000</td>
<td align="right">109450000</td>
<td align="right">85332000</td>
<td align="right">94299000</td>
<td align="right">110730000</td>
<td align="right">91926000</td>
<td align="right">74751000</td>
<td align="right">84026000</td>
<td align="right">86223000</td>
<td align="right">99722000</td>
<td align="right">72233000</td>
<td align="right">56151000</td>
<td align="right">97516000</td>
<td align="right">83401000</td>
</tr>
<tr class="even">
<td align="left">AAAAAAGAASGLPGPVAQGLK</td>
<td align="left">AAAAAAGAASGLPGPVAQGLK</td>
<td align="left">______________________________</td>
<td align="left">GAASGLPGPVAQGLKEALVDTLTGILSPVQ</td>
<td align="left">M</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">L</td>
<td align="left">K</td>
<td align="left">E</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">21</td>
<td align="right">0</td>
<td align="right">1747.9581</td>
<td align="left">Q96P70</td>
<td align="left">Q96P70</td>
<td align="right">2</td>
<td align="right">22</td>
<td align="left">IPO9</td>
<td align="left">Importin-9</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">2;3</td>
<td align="right">0.00e+00</td>
<td align="right">202.440</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1789100000</td>
<td align="left"></td>
<td align="left"></td>
<td align="right">3</td>
<td align="left">3783</td>
<td align="left">3</td>
<td align="left">77;78;79;80;81;82;83;84;85;86;87;88;89;90;91;92;93;94;95;96;97;98;99;100;101;102;103;104;105;106;107;108;109;110;111;112;113;114;115;116</td>
<td align="left">58;59;60;61;62;63;64;65;66;67;68;69;70;71;72;73;74;75;76;77;78;79;80;81;82;83;84;85;86;87;88;89;90;91;92;93;94;95;96;97;98;99;100;101;102;103;104;105;106;107</td>
<td align="right">85</td>
<td align="left"></td>
<td align="right">50</td>
<td align="right">97706000</td>
<td align="right">81244000</td>
<td align="right">87682000</td>
<td align="right">86622000</td>
<td align="right">77269000</td>
<td align="right">88508000</td>
<td align="right">94294000</td>
<td align="right">96324000</td>
<td align="right">76939000</td>
<td align="right">84650000</td>
<td align="right">73322000</td>
<td align="right">86806000</td>
<td align="right">96578000</td>
<td align="right">80020000</td>
<td align="right">93344000</td>
<td align="right">82709000</td>
<td align="right">75624000</td>
<td align="right">86506000</td>
<td align="right">79024000</td>
<td align="right">76020000</td>
</tr>
<tr class="odd">
<td align="left">AAAAAAGAGPEMVR</td>
<td align="left">AAAAAAGAGPEMVR</td>
<td align="left">______________________________</td>
<td align="left">MAAAAAAGAGPEMVRGQVFDVGPRYTNLSY</td>
<td align="left">M</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">V</td>
<td align="left">R</td>
<td align="left">G</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">14</td>
<td align="right">0</td>
<td align="right">1241.6187</td>
<td align="left">P28482</td>
<td align="left">P28482</td>
<td align="right">2</td>
<td align="right">15</td>
<td align="left">MAPK1</td>
<td align="left">Mitogen-activated protein kinase 1</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">2</td>
<td align="right">0.00e+00</td>
<td align="right">168.740</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left"></td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left"></td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left">By MS/MS</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">72178000</td>
<td align="left"></td>
<td align="left"></td>
<td align="right">4</td>
<td align="left">1600</td>
<td align="left">4</td>
<td align="left">117;118;119;120;121;122;123;124;125;126;127</td>
<td align="left">108;109;110;111;112;113;114;115;116;117</td>
<td align="right">109</td>
<td align="left"></td>
<td align="right">10</td>
<td align="right">0</td>
<td align="right">33141000</td>
<td align="right">35535000</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1664500</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">AAAAAAGSGTPREEEGPAGEAAASQPQAPTSVPGAR</td>
<td align="left">AAAAAAGSGTPREEEGPAGEAAASQPQAPTSVPGAR</td>
<td align="left">______________________________</td>
<td align="left">AASQPQAPTSVPGARLSRLPLARVKALVKA</td>
<td align="left">M</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">R</td>
<td align="left">L</td>
<td align="right">12</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">36</td>
<td align="right">1</td>
<td align="right">3287.5767</td>
<td align="left">Q9NR33</td>
<td align="left">Q9NR33</td>
<td align="right">2</td>
<td align="right">37</td>
<td align="left">POLE4</td>
<td align="left">DNA polymerase epsilon subunit 4</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left">3</td>
<td align="right">3.34e-05</td>
<td align="right">40.328</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">By MS/MS</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">6961000</td>
<td align="left"></td>
<td align="left"></td>
<td align="right">5</td>
<td align="left">4289</td>
<td align="left">5</td>
<td align="left">128</td>
<td align="left">118</td>
<td align="right">118</td>
<td align="left"></td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5891200</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>We can also retrieve the quantitative values for each set using
<code>assays()</code>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="sec-basics.html#cb22-1" tabindex="-1"></a><span class="fu">assay</span>(spikein[[<span class="dv">1</span>]])[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>##                        Intensity.a1 Intensity.a2 Intensity.a3 Intensity.a4
## AAAAAAAAAAAAAAAGAGAGAK      6378300            0            0            0
## AAAAAAAAAAGAAGGR           76718000     53670000     86511000     79070000
## AAAAAAALQAK               129520000     56753000    114890000    126100000
## AAAAAAGAASGLPGPVAQGLK     109030000     72676000    101320000     97545000
## AAAAAAGAGPEMVR                    0     29646000     41064000            0
##                        Intensity.b1
## AAAAAAAAAAAAAAAGAGAGAK            0
## AAAAAAAAAAGAAGGR           57211000
## AAAAAAALQAK                33394000
## AAAAAAGAASGLPGPVAQGLK      77269000
## AAAAAAGAGPEMVR                    0</code></pre>
</div>
</div>
<div id="sec-basic_preprocess" class="section level2" number="2.4">
<h2>
<span class="header-section-number">2.4</span> Data preprocessing<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-basic_preprocess')" onmouseout="reset_tooltip('sec-basic_preprocess-tooltip')"><span class="tooltiptext" id="sec-basic_preprocess-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Since we have a <code>QFeatures</code> object, we can directly make use of
<code>QFeatures</code>’ data preprocessing functionality<label for="tufte-sn-6" class="margin-toggle sidenote-number">6</label><input type="checkbox" id="tufte-sn-6" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">6</span> see also the <a href="https://rformassspectrometry.github.io/book/sec-quant.html">R for
mass spectrometry
book</a></span>. A
major advantage of <code>QFeatures</code> is it provides the power to build
highly modular workflows, where each step is carried out by a
dedicated function with a large choice of available methods and
parameters. This means that users can adapt the workflow to their
specific use case and their specific needs.</p>
<div id="sec-encode_missing" class="section level3" number="2.4.1">
<h3>
<span class="header-section-number">2.4.1</span> Encoding missing values<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-encode_missing')" onmouseout="reset_tooltip('sec-encode_missing-tooltip')"><span class="tooltiptext" id="sec-encode_missing-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>The first preprocessing step is to correctly encode the missing
values. It is important that missing values are encoded using <code>NA</code>.
For instance, non-observed values should not be
encoded with a zero because true zeros (the proteomic feature
is absent from the sample) cannot be distinguished from technical
zeros (the feature was missed by the instrument or could not be
identified). We therefore replace any zero in the quantitative data
with an <code>NA</code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="sec-basics.html#cb24-1" tabindex="-1"></a>spikein <span class="ot">&lt;-</span> <span class="fu">zeroIsNA</span>(spikein, <span class="fu">names</span>(spikein))</span></code></pre></div>
<p>Note that <code>msqrob2</code> can handle missing data without having to rely on
hard-to-verify imputation assumptions, which is our general recommendation. However, <code>msqrob2</code> does not
prevent users from using imputation, which can be performed with
<code>impute()</code> from the <code>QFeatures</code> package. Below, we show how one could
perform KNN imputation<label for="tufte-sn-7" class="margin-toggle sidenote-number">7</label><input type="checkbox" id="tufte-sn-7" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">7</span> We will however not evaluate the code in this
tutorial as our general advice is to avoid imputation. To run the
code, you’ll need to uncomment it first.</span> (see <code>?impute</code> for more
options).</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="sec-basics.html#cb25-1" tabindex="-1"></a><span class="co"># spikein &lt;- impute(</span></span>
<span id="cb25-2"><a href="sec-basics.html#cb25-2" tabindex="-1"></a><span class="co">#   spikein, method = "knn",</span></span>
<span id="cb25-3"><a href="sec-basics.html#cb25-3" tabindex="-1"></a><span class="co">#   i = names(spikein), name = paste0(names(spikein), "_imput")</span></span>
<span id="cb25-4"><a href="sec-basics.html#cb25-4" tabindex="-1"></a><span class="co"># )</span></span></code></pre></div>
</div>
<div id="sec-log2" class="section level3" number="2.4.2">
<h3>
<span class="header-section-number">2.4.2</span> Log2 transformation<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-log2')" onmouseout="reset_tooltip('sec-log2-tooltip')"><span class="tooltiptext" id="sec-log2-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>We need to log2 transform the intensities. We illustrate the rationale
using the spike-in data. For this, we perform a short data
manipulation pipeline:</p>
<ol style="list-style-type: decimal">
<li>We use <code>longForm()</code> to convert the <code>QFeatures</code> object into a long
table, where each row contains the quantitative information about
one observation, in which column, row and set it was found. Long
tables are particularly useful for manipulating data with the
<code>tidyverse</code> ecosystem, namely with <code>ggplot2</code> for visualisation.
<code>longForm()</code> also allows to include annotations, and we here
include <code>Mixture</code> and <code>TechRepMixture</code> for filtering and colouring.</li>
<li>
<code>longForm()</code> returns a <code>DataFrame</code> which we convert to a
<code>data.frame</code>.</li>
<li>We filter the data to keep only the data from peptide AEMSEYLFDK.</li>
</ol>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="sec-basics.html#cb26-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">longForm</span>(spikein, <span class="at">colvars =</span> <span class="fu">colnames</span>(<span class="fu">colData</span>(spikein))) <span class="sc">|&gt;</span> <span class="do">## 1.</span></span>
<span id="cb26-2"><a href="sec-basics.html#cb26-2" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span> <span class="do">## 2.</span></span>
<span id="cb26-3"><a href="sec-basics.html#cb26-3" tabindex="-1"></a>  <span class="fu">filter</span>(rowname <span class="sc">==</span> <span class="st">"AEMSEYLFDK"</span>)</span></code></pre></div>
<p>Next, we visualise the data using <code>ggplot2</code>. We will show the
intensities and log2-intensities for one of the peptides, AALEELVK, in
function of the E. coli spike-in concentration. We first define a common
plot from which we generate two plots, one without and the other with
log2 transformation of the quantitative values.</p>
<div class="float">
<img src="figure/unnamed-chunk-26-1.png" alt="plot of chunk unnamed-chunk-26"><div class="figcaption">plot of chunk unnamed-chunk-26</div>
</div>
<pre><code>## $ncol
## list()
## attr(,"class")
## [1] "waiver"
## 
## $nrow
## list()
## attr(,"class")
## [1] "waiver"
## 
## $byrow
## list()
## attr(,"class")
## [1] "waiver"
## 
## $widths
## list()
## attr(,"class")
## [1] "waiver"
## 
## $heights
## list()
## attr(,"class")
## [1] "waiver"
## 
## $guides
## list()
## attr(,"class")
## [1] "waiver"
## 
## $tag_level
## list()
## attr(,"class")
## [1] "waiver"
## 
## $axes
## list()
## attr(,"class")
## [1] "waiver"
## 
## $axis_titles
## [1] "collect_x"
## 
## $design
## list()
## attr(,"class")
## [1] "waiver"
## 
## attr(,"class")
## [1] "plot_layout"</code></pre>
<p>We can see that the variation around the mean for each concentration slightly increases as the mean increases. This is known as heteroskedasticity.
We will later see that <code>msqrob2</code> assumes that variance of the error
should be consistent across the different conditions. Upon,
log2-transformation we can see that the problem of unequal variation
is solved.</p>
<p>Another advantages of log2-transformation is that it provides a scale
that directly relates to biological interpretation. In biology, a
change induced by some condition often results in a fold change in
concentration. Interestingly, the log2 fold change (logFC), which is
the log of the ratio between two conditions, is identical to the
difference between the log of each condition.</p>
<p><span class="math display">\[log_2FC_{b-a} = log_2b - log_2a = log_2 \frac{b}{a}\]</span></p>
<p>This simplifies the modelling since the effects are now additive and
it simplifies the interpretation since a logFC of 1 means that the
abundances are <span class="math inline">\(2\times\)</span> higher in <span class="math inline">\(b\)</span> than in <span class="math inline">\(a\)</span>, a logFC of 2
means an increase of <span class="math inline">\(4\times\)</span>, for instance.</p>
<p>We perform log2-transformation with <code>logTransform()</code> from the
<code>QFeatures</code> package.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="sec-basics.html#cb28-1" tabindex="-1"></a>spikein <span class="ot">&lt;-</span> <span class="fu">logTransform</span>(</span>
<span id="cb28-2"><a href="sec-basics.html#cb28-2" tabindex="-1"></a>  spikein, <span class="st">"peptides"</span>, <span class="at">name =</span> <span class="st">"peptides_log"</span>, <span class="at">base =</span> <span class="dv">2</span></span>
<span id="cb28-3"><a href="sec-basics.html#cb28-3" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="sec-filter" class="section level3" number="2.4.3">
<h3>
<span class="header-section-number">2.4.3</span> Peptide filtering<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-filter')" onmouseout="reset_tooltip('sec-filter-tooltip')"><span class="tooltiptext" id="sec-filter-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>Filtering removes low-quality and unreliable peptides that would
otherwise introduce noise and artefacts in the data. There are many
possible criteria for peptide filtering:</p>
<ul>
<li>Reverse sequences</li>
<li>Only identified by modification site (only modified peptides
detected)</li>
<li>Razor peptides: non-unique peptides assigned to the protein group
with the most other peptides</li>
<li>Contaminants</li>
<li>Peptides few identifications</li>
<li>Proteins that are only identified with one or a few peptides</li>
<li>FDR of identification</li>
<li>…</li>
</ul>
<p>It is important that the filtering criteria are not distorting the distribution of the test statistics in the downstream analysis for features that are non-DA. It can be shown that filtering will not induce bias results when the filtering criterion is independent of test statistic. Here, the test statistics are based on the average difference between the log2-transformed intensities (effect size) and their corresponding standard error, which is a function of the residual standard deviation. The criteria that we proposed above are all based on the results of the identification step, hence, they are independent of the downstream test statistics that will be used to prioritize DA proteins.</p>
<p>We use <code>filterFeatures()</code> to perform the filtering. It uses
information from the <code>rowData</code> and a formula to generate a filter for
each feature (row) in each set across the object. If the filter
returns <code>TRUE</code>, the corresponding row is retained, otherwise it is
removed. Defining a filter through a formula offers a flexible
approach, allowing for any customised filter. This dataset requires an
extensive PSM filtering which is an ideal use case to demonstrate the
customisation of a filtering workflow.</p>
<div id="remove-failed-protein-inference" class="section level4" number="2.4.3.1">
<h4>
<span class="header-section-number">2.4.3.1</span> Remove failed protein inference</h4>
<p>We remove peptides that could not be mapped to a protein. We also
remove peptides that cannot be uniquely mapped to a single proteins
because its sequence is shared across multiple proteins. This often
occurs for homologs or for proteins that share similar functional
domains. Shared peptides are often mapped to protein groups, which are
the set of proteins that share the given peptides. Protein groups are
encoded by appending the constituting protein identifiers, separated
by a <code>";"</code>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="sec-basics.html#cb29-1" tabindex="-1"></a>spikein <span class="ot">&lt;-</span> <span class="fu">filterFeatures</span>(</span>
<span id="cb29-2"><a href="sec-basics.html#cb29-2" tabindex="-1"></a>  spikein, <span class="sc">~</span> Proteins <span class="sc">!=</span> <span class="st">""</span> <span class="sc">&amp;</span> <span class="do">## Remove failed protein inference</span></span>
<span id="cb29-3"><a href="sec-basics.html#cb29-3" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">";"</span>, Proteins)) <span class="do">## Remove protein groups</span></span></code></pre></div>
</div>
<div id="remove-reverse-sequences-and-contaminants" class="section level4" number="2.4.3.2">
<h4>
<span class="header-section-number">2.4.3.2</span> Remove reverse sequences and contaminants</h4>
<p>We now remove the peptides that map to decoy sequences or to
contaminants proteins. Decoy peptides, which consist of fake peptide
sequences generated by reversing a real amino-acid sequence, are used
during the database search to mitigating the number of random-hit PSM,
hence mitigating misidentification. Contaminant proteins are proteins
known to be artificially incorporated during the experiment, but that
are irrelevant to the biological system under study. Typical
contaminants are human or animal keratins (deposited by the
experimenter) or trypsin (used for protein digestion). It is important
to remove these peptides before performing statistical modelling,
otherwise these proteins will be accounted for during the multiple
test adjustment which will cause an unnecessary decrease of
statistical power. Note, that the column name of the contaminants in the peptides file differs according to the MaxQuant version. In our peptide.txt the contaminants are indicated in the column <code>Potential.contaminant</code>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="sec-basics.html#cb30-1" tabindex="-1"></a>spikein <span class="ot">&lt;-</span> <span class="fu">filterFeatures</span>(spikein, <span class="sc">~</span> Reverse <span class="sc">!=</span> <span class="st">"+"</span> <span class="sc">&amp;</span> <span class="do">## Remove decoys</span></span>
<span id="cb30-2"><a href="sec-basics.html#cb30-2" tabindex="-1"></a>                            Potential.contaminant <span class="sc">!=</span> <span class="st">"+"</span>) <span class="do">## Remove contaminants</span></span></code></pre></div>
</div>
<div id="remove-highly-missing-peptides" class="section level4" number="2.4.3.3">
<h4>
<span class="header-section-number">2.4.3.3</span> Remove highly missing peptides</h4>
<p>We keep peptides that were observed at last 4 times out of the <span class="math inline">\(n
= 20\)</span> samples, so that we can estimate the peptide characteristics. We tolerate the following proportion of NAs:
<span class="math inline">\(\text{pNA} = \frac{(n - 4)}{n} = 0.8\)</span>, so we keep peptides that
are observed in at least 20% of the samples, which corresponds to one treatment condition. This is an arbitrary
value that may need to be adjusted depending on the experiment and the
data set.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="sec-basics.html#cb31-1" tabindex="-1"></a>nObs <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb31-2"><a href="sec-basics.html#cb31-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(spikein[[<span class="st">"peptides_log"</span>]])</span>
<span id="cb31-3"><a href="sec-basics.html#cb31-3" tabindex="-1"></a>(spikein <span class="ot">&lt;-</span> <span class="fu">filterNA</span>(spikein, <span class="at">i =</span> <span class="st">"peptides_log"</span>, <span class="at">pNA =</span> (n <span class="sc">-</span> nObs) <span class="sc">/</span> n))</span></code></pre></div>
<pre><code>## An instance of class QFeatures (type: bulk) with 2 sets:
## 
##  [1] peptides: SummarizedExperiment with 30661 rows and 20 columns 
##  [2] peptides_log: SummarizedExperiment with 27850 rows and 20 columns</code></pre>
<p>We keep 27850 peptides upon filtering.</p>
</div>
</div>
<div id="sec-norm" class="section level3" number="2.4.4">
<h3>
<span class="header-section-number">2.4.4</span> Normalisation<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-norm')" onmouseout="reset_tooltip('sec-norm-tooltip')"><span class="tooltiptext" id="sec-norm-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>The most common objective of MS-based proteomics experiments is to
understand the biological changes in protein abundance between
experimental conditions. However, changes in measurements between
groups can be caused due to technical factors. For instance, there are
systematic fluctuations from run-to-run that shift the measured
intensity distribution. We can this explore as follows:</p>
<ol style="list-style-type: decimal">
<li>We extract the sets containing the log transformed data. This is
performed using <code>QFeatures</code>’ 3-way subsetting<label for="tufte-sn-8" class="margin-toggle sidenote-number">8</label><input type="checkbox" id="tufte-sn-8" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">8</span> We will explain this
with more details at the end of the <a href="sec-basics.html#sec-summarisation">summarisation step</a></span>.</li>
<li>We use <code>longForm()</code> to convert the <code>QFeatures</code> object into a long
table, including <code>lab</code> and <code>concentration</code> for filtering and
colouring.</li>
<li>We visualise the density of the quantitative values within each
sample. We colour each sample based on its spike-in condition.
Remember that each spike-in concentration has been acquired in
triplicate for each lab.</li>
</ol>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="sec-basics.html#cb33-1" tabindex="-1"></a>spikein[, , <span class="st">"peptides_log"</span>] <span class="sc">|&gt;</span> <span class="do">## 1.</span></span>
<span id="cb33-2"><a href="sec-basics.html#cb33-2" tabindex="-1"></a>  <span class="fu">longForm</span>(<span class="at">colvars =</span> <span class="fu">c</span>(<span class="st">"concentration"</span>, <span class="st">"condition"</span>)) <span class="sc">|&gt;</span> <span class="do">## 2.</span></span>
<span id="cb33-3"><a href="sec-basics.html#cb33-3" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb33-4"><a href="sec-basics.html#cb33-4" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="do">## 3.</span></span>
<span id="cb33-5"><a href="sec-basics.html#cb33-5" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> value,</span>
<span id="cb33-6"><a href="sec-basics.html#cb33-6" tabindex="-1"></a>      <span class="at">colour =</span> condition,</span>
<span id="cb33-7"><a href="sec-basics.html#cb33-7" tabindex="-1"></a>      <span class="at">group =</span> colname) <span class="sc">+</span></span>
<span id="cb33-8"><a href="sec-basics.html#cb33-8" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb33-9"><a href="sec-basics.html#cb33-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Intensity distribution for all samples"</span>,</span>
<span id="cb33-10"><a href="sec-basics.html#cb33-10" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Before normalisation"</span>)</span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-31-1.png" alt="plot of chunk unnamed-chunk-31"><div class="figcaption">plot of chunk unnamed-chunk-31</div>
</div>
<p>Even in this clean synthetic data set (same background with a small
percentage of E. coli lysate), the marginal peptide intensity
distributions across samples are not well aligned. Ignoring this
effect will increase the noise and reduce the statistical power of the
experiment, and may also, in case of unbalanced designs, introduce
confounding effects that will bias the results.</p>
<p>Therefore, normalisation will transform the data to put all the
distributions on the same location, such as centering on the mean or
the median, so that the distributions better coincide and overlap.</p>
<p>Here, we will use the Median of Ratios method of DESeq2:</p>
<ol style="list-style-type: decimal">
<li>We first create a pseudo-reference sample (row-wise mean of log2
intensities, which corresponds to the log2 transformed geometric
mean).</li>
<li>Calculate the log2 ratios of each sample w.r.t. the
pseudo-reference</li>
<li>Subsequently take the column wise median of these log2 ratios to
obtain the sample based normalisation factor on the log2 scale.</li>
<li>Subtract the norm factors from the intensities of each
corresponding column of the assay data and store the result in the
new assay peptides_norm. (We adopt the sweep function to the
<code>peptides_log</code> assay of the spikein QFeatures object with as
statistic the log2 normfactor <code>STATS=nf</code> the default function <code>FUN = "-"</code>, <code>MARGIN = 2</code> to substract the column wise log2 norm factor
from each entry of the corresponding assay data)</li>
</ol>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="sec-basics.html#cb34-1" tabindex="-1"></a>pseudoRef <span class="ot">&lt;-</span> <span class="fu">assay</span>(spikein[[<span class="st">"peptides_log"</span>]]) <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a href="sec-basics.html#cb34-2" tabindex="-1"></a>  <span class="fu">rowMeans</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co">#1. Calculate the row means </span></span>
<span id="cb34-3"><a href="sec-basics.html#cb34-3" tabindex="-1"></a>nfLog <span class="ot">&lt;-</span> <span class="fu">sweep</span>(</span>
<span id="cb34-4"><a href="sec-basics.html#cb34-4" tabindex="-1"></a>  <span class="fu">assay</span>(spikein[[<span class="st">"peptides_log"</span>]]), </span>
<span id="cb34-5"><a href="sec-basics.html#cb34-5" tabindex="-1"></a>  <span class="at">MARGIN =</span> <span class="dv">1</span>, </span>
<span id="cb34-6"><a href="sec-basics.html#cb34-6" tabindex="-1"></a>  pseudoRef) <span class="sc">|&gt;</span> <span class="co">#2. Subtract the row means row-by-row (MARGIN = 1)</span></span>
<span id="cb34-7"><a href="sec-basics.html#cb34-7" tabindex="-1"></a>  <span class="fu">colMedians</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co">#3. Calculate the column median </span></span>
<span id="cb34-8"><a href="sec-basics.html#cb34-8" tabindex="-1"></a>spikein <span class="ot">&lt;-</span> <span class="fu">sweep</span>( <span class="co">#4. Subtract log2 norm factor column-by-column (MARGIN = 2)</span></span>
<span id="cb34-9"><a href="sec-basics.html#cb34-9" tabindex="-1"></a>  spikein,</span>
<span id="cb34-10"><a href="sec-basics.html#cb34-10" tabindex="-1"></a>  <span class="at">MARGIN =</span> <span class="dv">2</span>,</span>
<span id="cb34-11"><a href="sec-basics.html#cb34-11" tabindex="-1"></a>  <span class="at">STATS =</span> nfLog,</span>
<span id="cb34-12"><a href="sec-basics.html#cb34-12" tabindex="-1"></a>  <span class="at">i =</span> <span class="st">"peptides_log"</span>,</span>
<span id="cb34-13"><a href="sec-basics.html#cb34-13" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">"peptides_norm"</span></span>
<span id="cb34-14"><a href="sec-basics.html#cb34-14" tabindex="-1"></a>)</span></code></pre></div>
<p>Formally, the function applies the follow operation on each sample <span class="math inline">\(i\)</span>
across all PSMs <span class="math inline">\(p\)</span>:</p>
<p><span class="math display">\[
y_{ip}^{\text{norm}} = y_{ip} - \hat{\mu}_i
\]</span></p>
<p>with <span class="math inline">\(\hat{\mu}_i\)</span> the norm factor. Upon normalisation, we can see
that the distribution nicely overlap (using the same code as above)</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="sec-basics.html#cb35-1" tabindex="-1"></a>spikein[, , <span class="st">"peptides_norm"</span>] <span class="sc">|&gt;</span> <span class="do">## 1.</span></span>
<span id="cb35-2"><a href="sec-basics.html#cb35-2" tabindex="-1"></a>  <span class="fu">longForm</span>(<span class="at">colvars =</span> <span class="fu">c</span>( <span class="st">"concentration"</span>, <span class="st">"condition"</span>)) <span class="sc">|&gt;</span> <span class="do">## 2.</span></span>
<span id="cb35-3"><a href="sec-basics.html#cb35-3" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb35-4"><a href="sec-basics.html#cb35-4" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="do">## 3.</span></span>
<span id="cb35-5"><a href="sec-basics.html#cb35-5" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> value,</span>
<span id="cb35-6"><a href="sec-basics.html#cb35-6" tabindex="-1"></a>      <span class="at">colour =</span> condition,</span>
<span id="cb35-7"><a href="sec-basics.html#cb35-7" tabindex="-1"></a>      <span class="at">group =</span> colname) <span class="sc">+</span></span>
<span id="cb35-8"><a href="sec-basics.html#cb35-8" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb35-9"><a href="sec-basics.html#cb35-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Intensity distribution for all samples"</span>,</span>
<span id="cb35-10"><a href="sec-basics.html#cb35-10" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"After normalisation"</span>)</span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-33-1.png" alt="plot of chunk unnamed-chunk-33"><div class="figcaption">plot of chunk unnamed-chunk-33</div>
</div>
<p>Beware there exist numerous types of normalisation methods (see
<code>?normalize</code>) and which method to use may be data set dependent. For
instance, some data set may show low overlap of distribution tails
upon normalisation indicating that a simple shift is not sufficient.
In micro-array literature, quantile normalisation is used to force the
median and all other quantiles to be equal across samples, but in
proteomics, quantile normalisation often introduces artifacts due to a
difference in missing peptides across samples (c.f. <a href="sec-basics.html#sec-lfq_challenges">Challenges</a>).</p>
<p>It is important to understand that most normalisation procedures
assume that the majority of the proteins do not change across
conditions and only a small proportion of the proteins are
differentially abundant. This assumption may not be valid in poorly
designed spike-in studies <span class="citation">(<label for="tufte-mn-6" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-6" class="margin-toggle">O’Brien et al. 2024<span class="marginnote">O’Brien, Jonathon J, Anil Raj, Aleksandr Gaun, Adam Waite, Wenzhou Li, David G Hendrickson, Niclas Olsson, and Fiona E McAllister. 2024. <span>“A Data Analysis Framework for Combining Multiple Batches Increases the Power of Isobaric Proteomics Experiments.”</span> <em>Nat. Methods</em> 21 (2): 290–300.</span>)</span> or for pull-down studies,
for example. Dedicated normalisation strategies are then required.</p>
</div>
<div id="sec-summarisation" class="section level3" number="2.4.5">
<h3>
<span class="header-section-number">2.4.5</span> Summarisation<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-summarisation')" onmouseout="reset_tooltip('sec-summarisation-tooltip')"><span class="tooltiptext" id="sec-summarisation-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>The objective of summarisation (also referred to as aggregation) is to
summarise the peptide-level intensities into a protein expression value.
We illustrate the motivation behind summarisation using all peptide-level data for
one of the E. coli proteins. We also focus on the lowest (a) and highest (e)
spike-in conditions. We illustrate the different peptides on the
x axis and plot their log2 normalised intensities across samples on y
axis. All the points belonging to the same sample are linked through a
grey line.</p>
<div class="float">
<img src="figure/unnamed-chunk-34-1.png" alt="plot of chunk unnamed-chunk-34"><div class="figcaption">plot of chunk unnamed-chunk-34</div>
</div>
<ol style="list-style-type: decimal">
<li>We can see that data for a protein can consist of many peptides,
hence the need for summarisation.</li>
<li>We observe that different peptides have different intensities
within the same sample (same line). This is because different
peptides have different properties and hence differ in their ionisation
efficiency, which will influence the detectability in the MS
(<a href="sec-basics.html#sec-lfq_challenges">Challenges</a>).</li>
<li>The peptide identification are inconsistent between groups of
interest. We can see the low-concentration group (condition a, red)
display more missing values than the high-concentration group
(condition e, blue). Moreover, which value is missing depends on
the peptide characteristics. All the peptides found in the
low-concentration group are the most intense peptides in the high
concentration group.</li>
<li>We also often find outliers, for instance, due to misidentification or fluctuations during MS acquisition.</li>
<li>These data also suggest pseudo-replication. The peptide intensities
in one same sample (dots connected by a line) are correlated, i.e.
they more alike than the peptide intensities between samples
(the lines do not perfectly align).</li>
</ol>
<p>The fact that different peptides have different intensities (2.), may
be inconsistently identified (3.) and/or quantified (4.), and show
sample correlations (5.) can lead to bias if we use simple
summarisation approaches such as summing or averaging the peptide
intensities for each sample. Instead, we will resort to more advanced
summarisation approaches to accommodate for these issues.</p>
<p>Here, we summarise the peptide-level data into protein intensities
through the robust summarisation approach <span class="citation">(<label for="tufte-mn-7" class="margin-toggle">⊕</label><input type="checkbox" id="tufte-mn-7" class="margin-toggle">Sticker et al. 2020<span class="marginnote">Sticker, Adriaan, Ludger Goeminne, Lennart Martens, and Lieven Clement. 2020. <span>“Robust Summarization and Inference in Proteome-Wide Label-Free Quantification.”</span> <em>Mol. Cell. Proteomics</em> 19 (7): 1209–19.</span>)</span> which is a
model approach that estimates for each protein <span class="math inline">\(P\)</span> separately:</p>
<p><span class="math display">\[
y_{ip} = \beta_p^\text{pep} + \beta_i^\text{samp} + \epsilon_{ip}
\]</span></p>
<p>where <span class="math inline">\(y_{ip}\)</span> is the log-normalised peptide intensity for peptide <span class="math inline">\(p\)</span>
belonging to protein <span class="math inline">\(P\)</span> in sample <span class="math inline">\(i\)</span>. <span class="math inline">\(\beta_p^\text{pep}\)</span> is the
average effect of peptide <span class="math inline">\(p\)</span>, which account for the fact that
different peptide yield different baseline intensities (see issue 2.
above). <span class="math inline">\(\beta_i^\text{samp}\)</span> is the average effect of sample <span class="math inline">\(i\)</span>. In
other words, it provides the estimated log2-transformed and normalised intensity of protein <span class="math inline">\(P\)</span> in
sample <span class="math inline">\(i\)</span> corrected for the peptide effect, which will be used as the summarised protein value.
<span class="math inline">\(\epsilon_{ip}\)</span> is the residual effect that cannot be explained by the
average sample and peptide effects. The method is called robust
summarisation because the estimation process will minimize <span class="math inline">\(\epsilon\)</span>
using a robust estimator<label for="tufte-sn-9" class="margin-toggle sidenote-number">9</label><input type="checkbox" id="tufte-sn-9" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">9</span> During robust estimation, the least squared
error minimisation, that is minimising <span class="math inline">\(\sum_i\mathbf{\epsilon}^2_i\)</span>, is
iteratively reweighted using Huber weights, i.e. <span class="math inline">\(\sum_iw_i\mathbf{\epsilon}^2_i\)</span>. This is internally
performed using <code>MASS::rlm()</code>.</span> that will down-weigh extreme values,
effectively tackling issue 4.</p>
<p><code>aggregateFeatures()</code> streamlines summarisation. It requires the name
of a <code>rowData</code> column to group the peptides into proteins (or
protein groups), here <code>Proteins</code>. We provide the summarisation
approach through the <code>fun</code> argument. Other summarisation methods
are available from the <code>MsCoreUtils</code> package, see <code>?aggregateFeatures</code>
for a comprehensive list. The function will return a <code>QFeatures</code>
object with a new set that we called <code>proteins</code>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="sec-basics.html#cb36-1" tabindex="-1"></a>(spikein <span class="ot">&lt;-</span> <span class="fu">aggregateFeatures</span>(</span>
<span id="cb36-2"><a href="sec-basics.html#cb36-2" tabindex="-1"></a>  spikein, <span class="at">i =</span> <span class="st">"peptides_norm"</span>, </span>
<span id="cb36-3"><a href="sec-basics.html#cb36-3" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">"proteins"</span>,</span>
<span id="cb36-4"><a href="sec-basics.html#cb36-4" tabindex="-1"></a>  <span class="at">fcol =</span> <span class="st">"Proteins"</span>, </span>
<span id="cb36-5"><a href="sec-basics.html#cb36-5" tabindex="-1"></a>  <span class="at">fun =</span> MsCoreUtils<span class="sc">::</span>robustSummary,</span>
<span id="cb36-6"><a href="sec-basics.html#cb36-6" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb36-7"><a href="sec-basics.html#cb36-7" tabindex="-1"></a>))</span></code></pre></div>
<pre><code>## An instance of class QFeatures (type: bulk) with 4 sets:
## 
##  [1] peptides: SummarizedExperiment with 30661 rows and 20 columns 
##  [2] peptides_log: SummarizedExperiment with 27850 rows and 20 columns 
##  [3] peptides_norm: SummarizedExperiment with 27850 rows and 20 columns 
##  [4] proteins: SummarizedExperiment with 4592 rows and 20 columns</code></pre>
<p>Note that all the links between peptides and proteins are kept<label for="tufte-sn-10" class="margin-toggle sidenote-number">10</label><input type="checkbox" id="tufte-sn-10" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">10</span> In
fact, this is also true for the previous transformation where the
peptides are linked across sets.</span>. This come particularly handy when
we want to extract all the data from one protein, P0AEE5 for
instance. This can be performed using the 3-way indexing. Every
<code>QFeatures</code> object contains one or more sets, each characterised by
multiple rows (peptides or proteins) and multiple columns (samples).
Therefore, <code>QFeatures</code> can subset data based on one or more of these
indices, <code>data[set_k, feature_i, sample_j]</code>. The first entry will
subset particular features. This can be the name of a peptide (e.g.
<code>DGQIQFVLLK</code>) or the name of a protein (<code>P0AEE5</code>).
The second entry selects the samples columns of interest. The third
entry selects the sets of interest. If an entry is left blank, all the
corresponding features, samples or sets will be selected. Let’s
extract all the data (all samples and all sets) related to the E. coli protein
(<code>P0AEE5</code>).</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="sec-basics.html#cb38-1" tabindex="-1"></a>spikein[<span class="st">"P0AEE5"</span>, , ]</span></code></pre></div>
<pre><code>## An instance of class QFeatures (type: bulk) with 4 sets:
## 
##  [1] peptides: SummarizedExperiment with 16 rows and 20 columns 
##  [2] peptides_log: SummarizedExperiment with 16 rows and 20 columns 
##  [3] peptides_norm: SummarizedExperiment with 16 rows and 20 columns 
##  [4] proteins: SummarizedExperiment with 1 rows and 20 columns</code></pre>
<p>The function extracted one protein and its 16 related peptides. This
functionality is particularly useful for plotting and exploring the
changes induces by the data processing. For instance:</p>
<ol style="list-style-type: decimal">
<li>We use the <code>QFeatures</code> subsetting functionality to keep only the
data for the E. coli protein P0AEE5 and the sets before and after
summarisation.</li>
<li>We use <code>longForm()</code> to convert the object for plotting.</li>
<li>We plot the intensities for each sample, facetting by set and
colouring by experimental condition, linking dots from the same
peptide or protein with a line.</li>
</ol>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="sec-basics.html#cb40-1" tabindex="-1"></a>spikein[<span class="st">"P0AEE5"</span>, , <span class="fu">c</span>(<span class="st">"peptides_norm"</span>, <span class="st">"proteins"</span>)] <span class="sc">|&gt;</span> <span class="do">## 1.</span></span>
<span id="cb40-2"><a href="sec-basics.html#cb40-2" tabindex="-1"></a>  <span class="fu">longForm</span>(<span class="at">colvars =</span> <span class="fu">colnames</span>(<span class="fu">colData</span>(spikein))) <span class="sc">|&gt;</span> <span class="do">## 2.</span></span>
<span id="cb40-3"><a href="sec-basics.html#cb40-3" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-4"><a href="sec-basics.html#cb40-4" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="do">## 3.</span></span>
<span id="cb40-5"><a href="sec-basics.html#cb40-5" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> colname, </span>
<span id="cb40-6"><a href="sec-basics.html#cb40-6" tabindex="-1"></a>      <span class="at">y =</span> value,</span>
<span id="cb40-7"><a href="sec-basics.html#cb40-7" tabindex="-1"></a>      <span class="at">group =</span> rowname) <span class="sc">+</span></span>
<span id="cb40-8"><a href="sec-basics.html#cb40-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb40-9"><a href="sec-basics.html#cb40-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> condition)) <span class="sc">+</span></span>
<span id="cb40-10"><a href="sec-basics.html#cb40-10" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> assay) <span class="sc">+</span></span>
<span id="cb40-11"><a href="sec-basics.html#cb40-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb40-12"><a href="sec-basics.html#cb40-12" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Data for protein P0AEE5 before and after summarisation"</span>)</span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-37-1.png" alt="plot of chunk unnamed-chunk-37"><div class="figcaption">plot of chunk unnamed-chunk-37</div>
</div>
</div>
<div id="protein-filtering" class="section level3" number="2.4.6">
<h3>
<span class="header-section-number">2.4.6</span> Protein filtering<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('protein-filtering')" onmouseout="reset_tooltip('protein-filtering-tooltip')"><span class="tooltiptext" id="protein-filtering-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>As a final step, we filter the protein data to keep proteins if they
are picked up in at least 4 samples so that most proteins have
observations in more than one group. So we tolerate a proportion of
<span class="math inline">\(\frac{n - 4}{n}\)</span> NAs.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="sec-basics.html#cb41-1" tabindex="-1"></a>nObs <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb41-2"><a href="sec-basics.html#cb41-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(spikein[[<span class="st">"proteins"</span>]])</span>
<span id="cb41-3"><a href="sec-basics.html#cb41-3" tabindex="-1"></a>spikein <span class="ot">&lt;-</span> <span class="fu">filterNA</span>(spikein, <span class="at">i =</span> <span class="st">"proteins"</span>, <span class="at">pNA =</span> (n <span class="sc">-</span> nObs) <span class="sc">/</span> n)</span></code></pre></div>
<p>The data processing is complete.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="sec-basics.html#cb42-1" tabindex="-1"></a><span class="fu">plot</span>(spikein)</span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-39-1.png" alt="plot of chunk unnamed-chunk-39"><div class="figcaption">plot of chunk unnamed-chunk-39</div>
</div>
</div>
</div>
<div id="sec_data_exploration" class="section level2" number="2.5">
<h2>
<span class="header-section-number">2.5</span> Data exploration<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec_data_exploration')" onmouseout="reset_tooltip('sec_data_exploration-tooltip')"><span class="tooltiptext" id="sec_data_exploration-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Data exploration aims to highlight the main sources of variation in
the data prior to data modelling and can pinpoint to outlying or
off-behaving samples. A common approach for data exploration is to
perform dimension reduction, such as Multi Dimensional Scaling (MDS).
We will first extract the set to explore along the sample annotations
(used for plot colouring).</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="sec-basics.html#cb43-1" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">getWithColData</span>(spikein, <span class="st">"proteins"</span>)</span></code></pre></div>
<p>We then use the <code>scater</code> package to compute and plot the PCA. For
technical reasons, it requires <code>SingleCellExperiment</code> class object,
but these can easily be generated from a <code>SummarizedExperiment</code>
object.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="sec-basics.html#cb44-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"scater"</span>)</span>
<span id="cb44-2"><a href="sec-basics.html#cb44-2" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">runMDS</span>(<span class="fu">as</span>(se, <span class="st">"SingleCellExperiment"</span>), <span class="at">exprs_values =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>We can now explore the data structure while coloring for the factor of
interest, here <code>condition</code>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="sec-basics.html#cb45-1" tabindex="-1"></a><span class="fu">plotMDS</span>(se, <span class="at">colour_by =</span> <span class="st">"condition"</span>) </span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-42-1.png" alt="plot of chunk unnamed-chunk-42"><div class="figcaption">plot of chunk unnamed-chunk-42</div>
</div>
<p>This plot reveals interesting information. First, we see that the
samples are nicely separated according to their spike-in condition.
Interestingly, the conditions are sorted by the concentration<label for="tufte-sn-11" class="margin-toggle sidenote-number">11</label><input type="checkbox" id="tufte-sn-11" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">11</span> Recall
that a to e condition imply low to high concentration.</span>. We also see
some structure in the second dimension. This would probe us to contact
the lab where the data were collected to ask if the samples were
obtained in batches. It demonstrates the power of data exploration for
QC.</p>
</div>
<div id="sec-modelling" class="section level2" number="2.6">
<h2>
<span class="header-section-number">2.6</span> Data modelling<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-modelling')" onmouseout="reset_tooltip('sec-modelling-tooltip')"><span class="tooltiptext" id="sec-modelling-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>We model the preprocessed data to answer biologically relevant
questions. As described above, each sample has been synthetically
created to contain a constant human background where E. coli lysates
were spiked in at five different concentration. Each sample
preparation has been replicated three times and each replicate has
been sent to three different labs. So, the research quest is “can our
model retrieve the proteins that have been spiked in across the
conditions?” Moreover, since we know the expected protein abundance in
each sample, we will also be able to assess how accurate the model can
estimate the average fold changes between spike-in conditions.</p>
<div id="sources-of-variation" class="section level3" number="2.6.1">
<h3>
<span class="header-section-number">2.6.1</span> Sources of variation<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sources-of-variation')" onmouseout="reset_tooltip('sources-of-variation-tooltip')"><span class="tooltiptext" id="sources-of-variation-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>In this experimental design, we can model a single source of variation:
spike-in concentration<label for="tufte-sn-12" class="margin-toggle sidenote-number">12</label><input type="checkbox" id="tufte-sn-12" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">12</span> Note that we have the spike-in concentration
encoded in two ways. <code>concentration</code> is encoded as a numerical value
and provides the actual concentration amount in fmol/µL. <code>condition</code>
is encoded as a factor, meaning that every concentration is regarded
as an independent group. We will use the latter encoding as most
common research questions consist of group-wise comparisons. The
modelling of concentration as a numeric will be discussed in a
<a href="#sec-numeric_model">dedicated section</a></span>. All remaining sources of
variability, e.g. pipetting errors, MS run to run variability, etc
will be lumped in the residual variability (error term).</p>
<p><strong>Spike-in condition effects</strong>: we model the source of variation
induced by the experimental treatment of interest as a fixed
effect, which we consider non-random, i.e. the treatment effect is
assumed to be the same in repeated experiments, but it is unknown
and has to be estimated.</p>
<p>When modelling a typical label-free experiment at the protein level,
the model boils down to the following linear model:</p>
<p><span class="math display">\[
y_i = \mathbf{x}^T_i \boldsymbol{\beta} + \epsilon_i
\]</span></p>
<p>with <span class="math inline">\(y_i\)</span> the <span class="math inline">\(\log_2\)</span>-normalised protein intensities in sample <span class="math inline">\(i\)</span>;
<span class="math inline">\(\mathbf{x}_i\)</span> a vector with the covariate pattern for the sample
encoding the intercept, spike-in condition<label for="tufte-sn-13" class="margin-toggle sidenote-number">13</label><input type="checkbox" id="tufte-sn-13" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">13</span> Categorical
variables are encoded using dummy coding.</span>, or other experimental factors; <span class="math inline">\(\boldsymbol{\beta}\)</span> the
vector of parameters that model the association between the covariates
and the outcome; and <span class="math inline">\(\epsilon_i\)</span> the residuals reflecting variation
that is not captured by the fixed effects. Note that <span class="math inline">\(\mathbf{x}_i\)</span>
allows for a flexible parameterisation of the treatment beyond a
single covariate, i.e. including a 1 for the intercept, continuous and
categorical variables as well as their interactions. We assume the
residuals to be independent and identically distributed (i.i.d)
according to a normal distribution with zero mean and constant
variance, i.e. <span class="math inline">\(\epsilon_{i} \sim N(0,\sigma_\epsilon^2)\)</span>, that can
differ from protein to protein.</p>
<p>In R, this model is encoded using the following simple formula<label for="tufte-sn-14" class="margin-toggle sidenote-number">14</label><input type="checkbox" id="tufte-sn-14" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">14</span> We
don’t need to specify the intercept as R automatically adds it during
model estimation. you can explicitly add it using <code>~ 1 + ...</code>, you can
also suppress it using <code>~ 0 +</code>. When an intercept is included, one of
the groups is defined as the reference group and its corresponding
model parameter is absorbed in the intercept. The residuals don’t need
to be specified as they are part of the model estimation process.</span>:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="sec-basics.html#cb46-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="er">~</span> condition</span></code></pre></div>
</div>
<div id="sec-msqrob" class="section level3" number="2.6.2">
<h3>
<span class="header-section-number">2.6.2</span> Model estimation<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-msqrob')" onmouseout="reset_tooltip('sec-msqrob-tooltip')"><span class="tooltiptext" id="sec-msqrob-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>We estimate the model with <code>msqrob()</code>. The function takes the
<code>QFeatures</code> object, extracts the quantitative values from the
<code>"proteins"</code> set generated during summarisation, and fits a simple
linear model with <code>condition</code> as covariate, which are
automatically retrieved from <code>colData(spikein)</code>.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="sec-basics.html#cb47-1" tabindex="-1"></a>spikein <span class="ot">&lt;-</span> <span class="fu">msqrob</span>(</span>
<span id="cb47-2"><a href="sec-basics.html#cb47-2" tabindex="-1"></a>  spikein,  <span class="at">i =</span> <span class="st">"proteins"</span>,</span>
<span id="cb47-3"><a href="sec-basics.html#cb47-3" tabindex="-1"></a>  <span class="at">formula =</span> model,</span>
<span id="cb47-4"><a href="sec-basics.html#cb47-4" tabindex="-1"></a>  <span class="at">ridge =</span> <span class="cn">TRUE</span>, <span class="at">robust =</span> <span class="cn">TRUE</span></span>
<span id="cb47-5"><a href="sec-basics.html#cb47-5" tabindex="-1"></a>)</span></code></pre></div>
<p>We enable M-estimation (<code>robust = TRUE</code>) for improved robustness
against outliers. We also enable ridge regression (<code>ridge = TRUE</code>).
Ridge regression stabilises the parameter estimation of fixed effects
in case where the number of parameters are close to the number of
available samples. The next chapter provides more details on <a href="sec-advanced.html#sec-robust">robust
regression</a> and <a href="sec-advanced.html#sec-ridge">ridge regression</a>.</p>
<p>The fitting results are available in the <code>msqrobModels</code> column of the
<code>rowData</code>. More specifically, the modelling output is stored in the
<code>rowData</code> as a <code>statModel</code> object, one model per row (protein). We
will see in a later section how to perform statistical inference on
the estimated parameters.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="sec-basics.html#cb48-1" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">rowData</span>(spikein[[<span class="st">"proteins"</span>]])[[<span class="st">"msqrobModels"</span>]]</span>
<span id="cb48-2"><a href="sec-basics.html#cb48-2" tabindex="-1"></a>models[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>## $A0AVT1
## Object of class "StatModel"
## The type is "lmer"
## There number of elements is 5 
## 
## $A0FGR8
## Object of class "StatModel"
## The type is "lmer"
## There number of elements is 5 
## 
## $A0MZ66
## Object of class "StatModel"
## The type is "lmer"
## There number of elements is 5</code></pre>
</div>
</div>
<div id="sec-inference" class="section level2" number="2.7">
<h2>
<span class="header-section-number">2.7</span> Statistical inference<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-inference')" onmouseout="reset_tooltip('sec-inference-tooltip')"><span class="tooltiptext" id="sec-inference-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>We can now convert the biological question “does the spike-in
condition affect the protein intensities?” into a statistical
hypothesis. In other words, we must convert this question in a
combination of the model parameters, also referred to as a contrast.
To aid defining contrasts, we will visualise the experimental design
using the <code>ExploreModelMatrix</code> package.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="sec-basics.html#cb50-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ExploreModelMatrix"</span>)</span>
<span id="cb50-2"><a href="sec-basics.html#cb50-2" tabindex="-1"></a><span class="fu">VisualizeDesign</span>(</span>
<span id="cb50-3"><a href="sec-basics.html#cb50-3" tabindex="-1"></a>  <span class="at">sampleData =</span>  <span class="fu">colData</span>(spikein),</span>
<span id="cb50-4"><a href="sec-basics.html#cb50-4" tabindex="-1"></a>  <span class="at">designFormula =</span> <span class="sc">~</span> condition,</span>
<span id="cb50-5"><a href="sec-basics.html#cb50-5" tabindex="-1"></a>  <span class="at">textSizeFitted =</span> <span class="dv">4</span></span>
<span id="cb50-6"><a href="sec-basics.html#cb50-6" tabindex="-1"></a>)<span class="sc">$</span>plotlist</span></code></pre></div>
<pre><code>## [[1]]</code></pre>
<div class="float">
<img src="figure/unnamed-chunk-45-1.png" alt="plot of chunk unnamed-chunk-45"><div class="figcaption">plot of chunk unnamed-chunk-45</div>
</div>
<p>Spike-in condition <code>a</code> is the reference class. So the mean log2
intensity for samples from condition a is <code>(Intercept)</code>. The mean
log2 expression for samples from condition b is ‘(Intercept) +
conditionB’. Hence, the average log2 fold change between conditionbB
and condition a is modelled using the parameter ‘conditionb’.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="sec-basics.html#cb52-1" tabindex="-1"></a><span class="fu">VisualizeDesign</span>(</span>
<span id="cb52-2"><a href="sec-basics.html#cb52-2" tabindex="-1"></a>  <span class="at">sampleData =</span>  <span class="fu">colData</span>(spikein),</span>
<span id="cb52-3"><a href="sec-basics.html#cb52-3" tabindex="-1"></a>  <span class="at">designFormula =</span> model,</span>
<span id="cb52-4"><a href="sec-basics.html#cb52-4" tabindex="-1"></a>  <span class="at">textSizeFitted =</span> <span class="dv">4</span></span>
<span id="cb52-5"><a href="sec-basics.html#cb52-5" tabindex="-1"></a>)<span class="sc">$</span>plotlist</span></code></pre></div>
<pre><code>## [[1]]</code></pre>
<div class="float">
<img src="figure/unnamed-chunk-46-1.png" alt="plot of chunk unnamed-chunk-46"><div class="figcaption">plot of chunk unnamed-chunk-46</div>
</div>
<p>With <code>getCoef()</code>, we can retrieve the estimated model parameters.
We start with extracting the model output, stored as <code>StatModel</code>
objects, from the <code>rowData</code>. Next, <code>getCoef()</code> retrieves the estimated
model parameters:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="sec-basics.html#cb54-1" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">rowData</span>(spikein[[<span class="st">"proteins"</span>]])<span class="sc">$</span>msqrobModels</span>
<span id="cb54-2"><a href="sec-basics.html#cb54-2" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">getCoef</span>(models[[<span class="dv">1</span>]])</span>
<span id="cb54-3"><a href="sec-basics.html#cb54-3" tabindex="-1"></a><span class="fu">head</span>(params)</span></code></pre></div>
<pre><code>##     (Intercept) ridgeconditionb ridgeconditionc ridgeconditiond ridgeconditione 
##        23.51052         0.00000         0.00000         0.00000         0.00000</code></pre>
<p>Note the <code>"ridge"</code> tag in front of the parameter names that indicates
the parameters have been estimated using ridge penalisation. The model
estimated 5 parameters to model the fixed and random
effects. However, we are interested, for this data set, in the
parameters that model the effect of <code>condition</code>.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="sec-basics.html#cb56-1" tabindex="-1"></a>params[<span class="fu">grep</span>(<span class="st">"condition"</span>, <span class="fu">names</span>(params))]</span></code></pre></div>
<pre><code>## ridgeconditionb ridgeconditionc ridgeconditiond ridgeconditione 
##               0               0               0               0</code></pre>
<p>For this protein we can see that the effects of condition are zero, as
expected since the protein is part of the human constant background.
However, we can explore the parameters for one of the E. coli
proteins.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="sec-basics.html#cb58-1" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">getCoef</span>(models[[<span class="st">"P0AEE5"</span>]])</span>
<span id="cb58-2"><a href="sec-basics.html#cb58-2" tabindex="-1"></a>params[<span class="fu">grep</span>(<span class="st">"condition"</span>, <span class="fu">names</span>(params))]</span></code></pre></div>
<pre><code>## ridgeconditionb ridgeconditionc ridgeconditiond ridgeconditione 
##       0.6612049       1.0635637       1.3121650       1.6876229</code></pre>
<p>Since this is a benchmark study and we know the concentration of A
(0.25 fmol/µL) and B (0.74 fmol/µL), the obvious answer is
<span class="math inline">\(log_2(0.74) - log_2(0.25) = 1.566\)</span>. The average log2 difference in
intensity between condition B and condition A that has been estimated
by the model is 0.6612049, rather close. Now,
the question is if we can conclude that the fold change between
condition B and condition A is statistically significant based on the
model output.</p>
<div id="hypothesis-testing" class="section level3" number="2.7.1">
<h3>
<span class="header-section-number">2.7.1</span> Hypothesis testing<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('hypothesis-testing')" onmouseout="reset_tooltip('hypothesis-testing-tooltip')"><span class="tooltiptext" id="hypothesis-testing-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>As shown above, the average difference in log2 intensity between
condition B and A after correcting for the lab effect is
<code>ridgeconditionb</code>. This combination of parameters is also called a
contrast. Thus, we assess the following nul hypothesis for this
contrast: ‘ridgeconditionb = 0’ with our statistical test.</p>
<p>As shown above, the average difference in log2 intensity between
condition b and a after correcting for the lab effect is
<code>ridgeconditionb</code>. This combination of parameters is also called a
contrast. Thus, we assess the following null hypothesis for this
contrast: <code>ridgeconditionb = 0</code> with our statistical test.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="sec-basics.html#cb60-1" tabindex="-1"></a>contrast <span class="ot">&lt;-</span> <span class="st">"ridgeconditionb = 0"</span></span></code></pre></div>
<p><code>makeContrast()</code> converts the hypothesis into a formal contrast matrix
with parameter names as rows and hypotheses in columns<label for="tufte-sn-15" class="margin-toggle sidenote-number">15</label><input type="checkbox" id="tufte-sn-15" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">15</span> Note, that we only need to specify the names of the model parameters that are involved in the contrast when using the make contrast function. The hypothesisTest function below will then subset the relevant part from the model output. Also, note that the contrast matrix in this example is trivial. However, we will
<a href="sec-basics.html#sec-multiple_contrasts">later</a> show how to asses multiple hypotheses
at once and then the constrast matrix consists of multiple
columns, with one column for each contrast</span>.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="sec-basics.html#cb61-1" tabindex="-1"></a>(L <span class="ot">&lt;-</span> <span class="fu">makeContrast</span>(</span>
<span id="cb61-2"><a href="sec-basics.html#cb61-2" tabindex="-1"></a>  <span class="st">"ridgeconditionb = 0"</span>,</span>
<span id="cb61-3"><a href="sec-basics.html#cb61-3" tabindex="-1"></a>  <span class="st">"ridgeconditionb"</span></span>
<span id="cb61-4"><a href="sec-basics.html#cb61-4" tabindex="-1"></a>))</span></code></pre></div>
<pre><code>##                 ridgeconditionb
## ridgeconditionb               1</code></pre>
<p>We can now test our null hypothesis using <code>hypothesisTest()</code> which
takes the <code>QFeatures</code> object with the fitted model and the contrast we
just built. <code>msqrob2</code> automatically applies the hypothesis
testing to all proteins in the data.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="sec-basics.html#cb63-1" tabindex="-1"></a>spikein <span class="ot">&lt;-</span> <span class="fu">hypothesisTest</span>(spikein, <span class="at">i =</span> <span class="st">"proteins"</span>, <span class="at">contrast =</span> L)</span></code></pre></div>
<p>The results are stored in the set containing the model, here
<code>proteins</code>. We retrieve the results from the <code>rowData</code>.
We also add variable <code>isEcoli</code> to indicate if the protein is spiked
(from E. coli).</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="sec-basics.html#cb64-1" tabindex="-1"></a>inference <span class="ot">&lt;-</span> <span class="fu">rowData</span>(spikein[[<span class="st">"proteins"</span>]])<span class="sc">$</span>ridgeconditionb</span>
<span id="cb64-2"><a href="sec-basics.html#cb64-2" tabindex="-1"></a>inference<span class="sc">$</span>Protein <span class="ot">&lt;-</span> <span class="fu">rownames</span>(inference)</span>
<span id="cb64-3"><a href="sec-basics.html#cb64-3" tabindex="-1"></a>inference<span class="sc">$</span>isEcoli <span class="ot">&lt;-</span> inference<span class="sc">$</span>Protein <span class="sc">%in%</span> ecoli</span>
<span id="cb64-4"><a href="sec-basics.html#cb64-4" tabindex="-1"></a><span class="fu">head</span>(inference)</span></code></pre></div>
<pre><code>##              logFC           se       df         t      pval   adjPval Protein
## A0AVT1  0.00000000 8.086020e-11 20.95446  0.000000 1.0000000 1.0000000  A0AVT1
## A0FGR8  0.06647992 3.917165e-02 17.43077  1.697144 0.1074520 0.7248094  A0FGR8
## A0MZ66 -0.04609821 3.641208e-02 19.31900 -1.266014 0.2205624 1.0000000  A0MZ66
## A1L0T0  0.00000000 1.740448e-10 20.95446  0.000000 1.0000000 1.0000000  A1L0T0
## A1X283  0.00000000 3.718563e-10  8.95446  0.000000 1.0000000 1.0000000  A1X283
## A2RRP1  0.00000000 8.224779e-11 19.95446  0.000000 1.0000000 1.0000000  A2RRP1
##        isEcoli
## A0AVT1   FALSE
## A0FGR8   FALSE
## A0MZ66   FALSE
## A1L0T0   FALSE
## A1X283   FALSE
## A2RRP1   FALSE</code></pre>
<p>Note, that missing values can occur because data modelling
resulted in a <code>fitError</code> (the <a href="sec-advanced.html#sec-fiterror">advanced vignette</a>
describes how to deal with proteins that could not be fit).</p>
<p>The results also include an adjusted p-value for each protein <span class="math inline">\(j\)</span> to
correct for multiple testing using the Benjamini-Hochberg False
Discovery Rate (FDR) method, which represents an estimate of the
minimum FDR at which the test result for protein <span class="math inline">\(j\)</span> is considered
significant, i.e. the expected fraction of false positives that are
reported in the shortest top list of the most significant proteins
that include protein <span class="math inline">\(j\)</span>.</p>
</div>
<div id="volcano-plots" class="section level3" number="2.7.2">
<h3>
<span class="header-section-number">2.7.2</span> Volcano plots<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('volcano-plots')" onmouseout="reset_tooltip('volcano-plots-tooltip')"><span class="tooltiptext" id="volcano-plots-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>A volcano plot is a common visualisation that provides an overview of
the hypothesis testing results, plotting the <span class="math inline">\(-\log_{10}\)</span> p-value<label for="tufte-sn-16" class="margin-toggle sidenote-number">16</label><input type="checkbox" id="tufte-sn-16" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">16</span> Note, that upon this transformation a value of 1 represents a p-value of 0.1, 2 a p-value of 0.01, 3 a p-value of 0.001, etc.</span> as a function of
the estimated log fold change. Volcano plots can be used to highlight
the most interesting proteins that have large fold changes and/or are
highly significant. We can use the table above directly to build a
volcano plot using <code>ggplot2</code> functionality. We also highlight which
proteins are UPS standards, known to be differentially abundant by
experimental design.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="sec-basics.html#cb66-1" tabindex="-1"></a>inference <span class="sc">|&gt;</span> </span>
<span id="cb66-2"><a href="sec-basics.html#cb66-2" tabindex="-1"></a>  <span class="fu">na.exclude</span>() <span class="sc">|&gt;</span></span>
<span id="cb66-3"><a href="sec-basics.html#cb66-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb66-4"><a href="sec-basics.html#cb66-4" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> logFC,</span>
<span id="cb66-5"><a href="sec-basics.html#cb66-5" tabindex="-1"></a>        <span class="at">y =</span> <span class="sc">-</span><span class="fu">log10</span>(pval),</span>
<span id="cb66-6"><a href="sec-basics.html#cb66-6" tabindex="-1"></a>        <span class="at">color =</span> isEcoli,</span>
<span id="cb66-7"><a href="sec-basics.html#cb66-7" tabindex="-1"></a>        <span class="at">shape =</span> adjPval <span class="sc">&lt;</span> <span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb66-8"><a href="sec-basics.html#cb66-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb66-9"><a href="sec-basics.html#cb66-9" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">log2</span>(<span class="fl">4.5</span>) <span class="sc">-</span> <span class="fu">log2</span>(<span class="dv">3</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb66-10"><a href="sec-basics.html#cb66-10" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb66-11"><a href="sec-basics.html#cb66-11" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey20"</span>, <span class="st">"firebrick"</span>), <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb66-12"><a href="sec-basics.html#cb66-12" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Human proteins"</span>, <span class="st">"Ecoli spikein"</span>)</span>
<span id="cb66-13"><a href="sec-basics.html#cb66-13" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb66-14"><a href="sec-basics.html#cb66-14" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Statistical inference results"</span>,</span>
<span id="cb66-15"><a href="sec-basics.html#cb66-15" tabindex="-1"></a>          <span class="fu">paste0</span>(<span class="st">"H0: "</span>, <span class="fu">colnames</span>(L), <span class="st">" = 0"</span>))</span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-54-1.png" alt="plot of chunk unnamed-chunk-54"><div class="figcaption">plot of chunk unnamed-chunk-54</div>
</div>
<p>We retrieve the proteins that are significantly differentially
abundant based on the FDR-adjusted p-value (<code>adjPval</code>). Note that the
majority of the differentially abundant proteins are E. coli proteins.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="sec-basics.html#cb67-1" tabindex="-1"></a><span class="fu">table</span>(<span class="at">is_significant =</span> inference<span class="sc">$</span>adjPval <span class="sc">&lt;</span> <span class="fl">0.05</span>, </span>
<span id="cb67-2"><a href="sec-basics.html#cb67-2" tabindex="-1"></a>      <span class="at">is_ecoli =</span> inference<span class="sc">$</span>isEcoli)</span></code></pre></div>
<pre><code>##               is_ecoli
## is_significant FALSE TRUE
##          FALSE  3760  203
##          TRUE     19  443</code></pre>
<p>Because we known the ground truth, we can also provide a list with
false positives, true positives and the false discovery proprotion
(FP/(FP+TP)) at a nominal 5% FDR level.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="sec-basics.html#cb69-1" tabindex="-1"></a>inference <span class="sc">|&gt;</span> </span>
<span id="cb69-2"><a href="sec-basics.html#cb69-2" tabindex="-1"></a>  <span class="fu">filter</span>(adjPval <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">|&gt;</span></span>
<span id="cb69-3"><a href="sec-basics.html#cb69-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb69-4"><a href="sec-basics.html#cb69-4" tabindex="-1"></a>    <span class="at">fp =</span> <span class="fu">sum</span>(<span class="sc">!</span>isEcoli), </span>
<span id="cb69-5"><a href="sec-basics.html#cb69-5" tabindex="-1"></a>    <span class="at">tp =</span> <span class="fu">sum</span>(isEcoli), </span>
<span id="cb69-6"><a href="sec-basics.html#cb69-6" tabindex="-1"></a>    <span class="at">fdp =</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="sc">!</span>isEcoli) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>##   fp  tp  fdp
## 1 19 443 4.11</code></pre>
</div>
<div id="sec-heatmaps" class="section level3" number="2.7.3">
<h3>
<span class="header-section-number">2.7.3</span> Heatmaps<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-heatmaps')" onmouseout="reset_tooltip('sec-heatmaps-tooltip')"><span class="tooltiptext" id="sec-heatmaps-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>We can explore the quantitative data of the significant proteins using
a heatmap. First, we select the names of the proteins that were
declared significant between condition A and condition B and extract
their quantitative data.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="sec-basics.html#cb71-1" tabindex="-1"></a>sigNames <span class="ot">&lt;-</span> inference<span class="sc">$</span>Protein[<span class="sc">!</span><span class="fu">is.na</span>(inference<span class="sc">$</span>adjPval) <span class="sc">&amp;</span> inference<span class="sc">$</span>adjPval <span class="sc">&lt;</span> <span class="fl">0.05</span>]</span>
<span id="cb71-2"><a href="sec-basics.html#cb71-2" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">getWithColData</span>(spikein, <span class="st">"proteins"</span>)</span>
<span id="cb71-3"><a href="sec-basics.html#cb71-3" tabindex="-1"></a>se <span class="ot">&lt;-</span> se[sigNames, se<span class="sc">$</span>condition <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>)]</span></code></pre></div>
<p>Next, we extract the quantitative data and scale by rows<label for="tufte-sn-17" class="margin-toggle sidenote-number">17</label><input type="checkbox" id="tufte-sn-17" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">17</span> The
<code>scales()</code> function aligns the means and the centered standard
deviations by column. Since we want to scale by row, we need to
transpose (<code>t())</code>) before scaling and transpose back after scaling.
Scaling the data will remove changes in feature intensities that are
caused by uninteresting changes in ionisation efficiency.</span> with
<code>assay()</code>. We will create a heatmap using the <code>ComplexHeatmap</code>
package, which enables heatmap annotations. We will annotate the
heatmap using our model variables <code>condition</code> and <code>lab</code>.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="sec-basics.html#cb72-1" tabindex="-1"></a>quants <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">scale</span>(<span class="fu">t</span>(<span class="fu">assay</span>(se))))</span>
<span id="cb72-2"><a href="sec-basics.html#cb72-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ComplexHeatmap"</span>)</span>
<span id="cb72-3"><a href="sec-basics.html#cb72-3" tabindex="-1"></a>annotations <span class="ot">&lt;-</span> <span class="fu">columnAnnotation</span>(</span>
<span id="cb72-4"><a href="sec-basics.html#cb72-4" tabindex="-1"></a>  <span class="at">condition =</span> se<span class="sc">$</span>condition</span>
<span id="cb72-5"><a href="sec-basics.html#cb72-5" tabindex="-1"></a>)</span></code></pre></div>
<p>We now make the heatmap.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="sec-basics.html#cb73-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>) <span class="do">## annotation colours are randomly generated by default</span></span>
<span id="cb73-2"><a href="sec-basics.html#cb73-2" tabindex="-1"></a><span class="fu">Heatmap</span>(</span>
<span id="cb73-3"><a href="sec-basics.html#cb73-3" tabindex="-1"></a> quants, <span class="at">name =</span> <span class="st">"log2 intensity"</span>,</span>
<span id="cb73-4"><a href="sec-basics.html#cb73-4" tabindex="-1"></a> <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>,</span>
<span id="cb73-5"><a href="sec-basics.html#cb73-5" tabindex="-1"></a> <span class="at">top_annotation =</span> annotations</span>
<span id="cb73-6"><a href="sec-basics.html#cb73-6" tabindex="-1"></a>)</span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-59-1.png" alt="plot of chunk unnamed-chunk-59"><div class="figcaption">plot of chunk unnamed-chunk-59</div>
</div>
</div>
<div id="fold-change-distributions" class="section level3" number="2.7.4">
<h3>
<span class="header-section-number">2.7.4</span> Fold change distributions<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('fold-change-distributions')" onmouseout="reset_tooltip('fold-change-distributions-tooltip')"><span class="tooltiptext" id="fold-change-distributions-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>As this is a spike-in study with known ground truth, we can also plot
the log2 fold change distributions against the expected values, in
this case 0 for the human proteins and 0.585 for the
E. coli proteins.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="sec-basics.html#cb74-1" tabindex="-1"></a><span class="fu">ggplot</span>(inference) <span class="sc">+</span></span>
<span id="cb74-2"><a href="sec-basics.html#cb74-2" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">y =</span> logFC,</span>
<span id="cb74-3"><a href="sec-basics.html#cb74-3" tabindex="-1"></a>      <span class="at">x =</span> isEcoli,</span>
<span id="cb74-4"><a href="sec-basics.html#cb74-4" tabindex="-1"></a>      <span class="at">colour =</span> isEcoli) <span class="sc">+</span></span>
<span id="cb74-5"><a href="sec-basics.html#cb74-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb74-6"><a href="sec-basics.html#cb74-6" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">log2</span>(<span class="fl">4.5</span>) <span class="sc">-</span> <span class="fu">log2</span>(<span class="dv">3</span>)), </span>
<span id="cb74-7"><a href="sec-basics.html#cb74-7" tabindex="-1"></a>             <span class="at">colour =</span> <span class="fu">c</span>(<span class="st">"grey20"</span>, <span class="st">"firebrick"</span>)) <span class="sc">+</span></span>
<span id="cb74-8"><a href="sec-basics.html#cb74-8" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb74-9"><a href="sec-basics.html#cb74-9" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey20"</span>, <span class="st">"firebrick"</span>), <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb74-10"><a href="sec-basics.html#cb74-10" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Human proteins"</span>, <span class="st">"E. coli proteins"</span>)</span>
<span id="cb74-11"><a href="sec-basics.html#cb74-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb74-12"><a href="sec-basics.html#cb74-12" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Distribution of the log2 fold changes"</span>,</span>
<span id="cb74-13"><a href="sec-basics.html#cb74-13" tabindex="-1"></a>          <span class="fu">paste0</span>(<span class="st">"Hypothesis test: "</span>, <span class="fu">colnames</span>(L), <span class="st">" = 0"</span>))</span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-60-1.png" alt="plot of chunk unnamed-chunk-60"><div class="figcaption">plot of chunk unnamed-chunk-60</div>
</div>
<p>Estimated log2 fold change for human proteins are closely distributed
around 0, as expected. log2 fold changes for E. coli proteins are
distributed around the fold changes induced by the experimental
design.</p>
</div>
<div id="sec-detail_plot" class="section level3" number="2.7.5">
<h3>
<span class="header-section-number">2.7.5</span> Detail plots<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-detail_plot')" onmouseout="reset_tooltip('sec-detail_plot-tooltip')"><span class="tooltiptext" id="sec-detail_plot-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>We can explore the data for a protein to validate the statistical
inference results. For example, let’s explore the peptide and the
summarised protein intensities for the protein with the most
significant difference.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="sec-basics.html#cb75-1" tabindex="-1"></a>(targetProtein <span class="ot">&lt;-</span> <span class="fu">rownames</span>(inference)[<span class="fu">which.min</span>(inference<span class="sc">$</span>adjPval)])</span></code></pre></div>
<pre><code>## [1] "P0A799"</code></pre>
<p>To obtain the required data, we perform a little data manipulation
pipeline:</p>
<p>We use the <code>QFeatures</code> subsetting functionality to retrieve all data
related to and focusing on the <code>peptides_log</code> and
<code>proteins</code> sets that contains the peptide ion data used for model
fitting. We then convert the data with <code>longForm()</code> for plotting.
Finally, we plot the log2 normalised intensities for each sample at
the protein and at the peptide level. Since multiple peptides are
recorded for the protein, we link peptides across samples using a grey
line. Samples are colored according to E. coli spike-in condition.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="sec-basics.html#cb77-1" tabindex="-1"></a>spikein[targetProtein, , <span class="fu">c</span>(<span class="st">"peptides_log"</span>, <span class="st">"proteins"</span>)] <span class="sc">|&gt;</span> <span class="co">#1</span></span>
<span id="cb77-2"><a href="sec-basics.html#cb77-2" tabindex="-1"></a>  <span class="fu">longForm</span>(<span class="at">colvars =</span> <span class="fu">colnames</span>(<span class="fu">colData</span>(spikein)), <span class="co">#2</span></span>
<span id="cb77-3"><a href="sec-basics.html#cb77-3" tabindex="-1"></a>           <span class="at">rowvars =</span> <span class="st">"Proteins"</span>) <span class="sc">|&gt;</span></span>
<span id="cb77-4"><a href="sec-basics.html#cb77-4" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb77-5"><a href="sec-basics.html#cb77-5" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb77-6"><a href="sec-basics.html#cb77-6" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> colname,</span>
<span id="cb77-7"><a href="sec-basics.html#cb77-7" tabindex="-1"></a>      <span class="at">y =</span> value) <span class="sc">+</span></span>
<span id="cb77-8"><a href="sec-basics.html#cb77-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> rowname), <span class="at">linewidth =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb77-9"><a href="sec-basics.html#cb77-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> condition)) <span class="sc">+</span></span>
<span id="cb77-10"><a href="sec-basics.html#cb77-10" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> assay, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb77-11"><a href="sec-basics.html#cb77-11" tabindex="-1"></a>  <span class="fu">ggtitle</span>(targetProtein) <span class="sc">+</span></span>
<span id="cb77-12"><a href="sec-basics.html#cb77-12" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb77-13"><a href="sec-basics.html#cb77-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-62-1.png" alt="plot of chunk unnamed-chunk-62"><div class="figcaption">plot of chunk unnamed-chunk-62</div>
</div>
</div>
</div>
<div id="going-further" class="section level2" number="2.8">
<h2>
<span class="header-section-number">2.8</span> Going further<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('going-further')" onmouseout="reset_tooltip('going-further-tooltip')"><span class="tooltiptext" id="going-further-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<div id="sec-multiple_contrasts" class="section level3" number="2.8.1">
<h3>
<span class="header-section-number">2.8.1</span> Testing muliple contrasts at once<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('sec-multiple_contrasts')" onmouseout="reset_tooltip('sec-multiple_contrasts-tooltip')"><span class="tooltiptext" id="sec-multiple_contrasts-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>We showed how to perform a hypothesis test to answer the question
“which proteins change in abundance between condition b and condition
c?”. However, since we have 5 conditions, we can do further
comparisons. <code>msqrob2</code> can assess multiple hypothesis at once. Like
above we must provide which hypotheses we want to compare.
<code>createPairwiseContrasts()</code> will generate all possible comparisons
between <code>condition</code> level. The function requires the model
specification that has been estimated and the sample annotation from
the data. We also specify that we estimated the model using ridge
regression, which influences parameter names.</p>
<p><strong>TODO</strong>: add automatic pairwise comparisons function to msqrob2</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="sec-basics.html#cb78-1" tabindex="-1"></a>(allHypotheses <span class="ot">&lt;-</span> <span class="fu">createPairwiseContrasts</span>(</span>
<span id="cb78-2"><a href="sec-basics.html#cb78-2" tabindex="-1"></a>  model, <span class="fu">colData</span>(spikein), <span class="st">"condition"</span>, <span class="at">ridge =</span> <span class="cn">TRUE</span></span>
<span id="cb78-3"><a href="sec-basics.html#cb78-3" tabindex="-1"></a>))</span></code></pre></div>
<pre><code>##  [1] "ridgeconditionc - ridgeconditionb = 0"
##  [2] "ridgeconditiond - ridgeconditionb = 0"
##  [3] "ridgeconditione - ridgeconditionb = 0"
##  [4] "ridgeconditiond - ridgeconditionc = 0"
##  [5] "ridgeconditione - ridgeconditionc = 0"
##  [6] "ridgeconditione - ridgeconditiond = 0"
##  [7] "ridgeconditionb = 0"                  
##  [8] "ridgeconditionc = 0"                  
##  [9] "ridgeconditiond = 0"                  
## [10] "ridgeconditione = 0"</code></pre>
<p>We now run the same workflow as above for a single hypothesis, except
that here <code>allHypotheses</code> is a vector of contrasts.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="sec-basics.html#cb80-1" tabindex="-1"></a>(L <span class="ot">&lt;-</span> <span class="fu">makeContrast</span>(</span>
<span id="cb80-2"><a href="sec-basics.html#cb80-2" tabindex="-1"></a>  allHypotheses,</span>
<span id="cb80-3"><a href="sec-basics.html#cb80-3" tabindex="-1"></a>  <span class="at">parameterNames =</span> <span class="fu">paste0</span>(<span class="st">"ridgecondition"</span>, <span class="fu">c</span>(<span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"e"</span>))</span>
<span id="cb80-4"><a href="sec-basics.html#cb80-4" tabindex="-1"></a>))</span></code></pre></div>
<pre><code>##                 ridgeconditionc - ridgeconditionb
## ridgeconditionb                                -1
## ridgeconditionc                                 1
## ridgeconditiond                                 0
## ridgeconditione                                 0
##                 ridgeconditiond - ridgeconditionb
## ridgeconditionb                                -1
## ridgeconditionc                                 0
## ridgeconditiond                                 1
## ridgeconditione                                 0
##                 ridgeconditione - ridgeconditionb
## ridgeconditionb                                -1
## ridgeconditionc                                 0
## ridgeconditiond                                 0
## ridgeconditione                                 1
##                 ridgeconditiond - ridgeconditionc
## ridgeconditionb                                 0
## ridgeconditionc                                -1
## ridgeconditiond                                 1
## ridgeconditione                                 0
##                 ridgeconditione - ridgeconditionc
## ridgeconditionb                                 0
## ridgeconditionc                                -1
## ridgeconditiond                                 0
## ridgeconditione                                 1
##                 ridgeconditione - ridgeconditiond ridgeconditionb
## ridgeconditionb                                 0               1
## ridgeconditionc                                 0               0
## ridgeconditiond                                -1               0
## ridgeconditione                                 1               0
##                 ridgeconditionc ridgeconditiond ridgeconditione
## ridgeconditionb               0               0               0
## ridgeconditionc               1               0               0
## ridgeconditiond               0               1               0
## ridgeconditione               0               0               1</code></pre>
<p>The contrast contains multiple hypotheses (multiple column) that
involve multiple parameters (multiple rows).</p>
<p>We use again <code>hypothesisTest()</code> for performing the hypothesis test. We
already generated results for the contrast <code>ridgeconditionb = 0</code> and
the function will throw an error by default, but we can overwrite the
results with the argument <code>overwrite = TRUE</code>.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="sec-basics.html#cb82-1" tabindex="-1"></a>spikein <span class="ot">&lt;-</span> <span class="fu">hypothesisTest</span>(spikein, <span class="at">i =</span> <span class="st">"proteins"</span>, L, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>We retrieve the inference tables from the <code>rowData</code> to generate the
volcano plots.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="sec-basics.html#cb83-1" tabindex="-1"></a>inferences <span class="ot">&lt;-</span> <span class="fu">rowData</span>(spikein[[<span class="st">"proteins"</span>]])[, <span class="fu">colnames</span>(L)]</span></code></pre></div>
<p>We here use a <code>lapply()</code> loop to generate additional information, and
then combine all the tables in a single table.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="sec-basics.html#cb84-1" tabindex="-1"></a>inferences <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">colnames</span>(inferences), <span class="cf">function</span>(i) {</span>
<span id="cb84-2"><a href="sec-basics.html#cb84-2" tabindex="-1"></a>  inference <span class="ot">&lt;-</span> inferences[[i]]</span>
<span id="cb84-3"><a href="sec-basics.html#cb84-3" tabindex="-1"></a>  inference<span class="sc">$</span>Protein <span class="ot">&lt;-</span> <span class="fu">rownames</span>(inference)</span>
<span id="cb84-4"><a href="sec-basics.html#cb84-4" tabindex="-1"></a>  inference<span class="sc">$</span>isEcoli <span class="ot">&lt;-</span> inference<span class="sc">$</span>Protein <span class="sc">%in%</span> ecoli</span>
<span id="cb84-5"><a href="sec-basics.html#cb84-5" tabindex="-1"></a>  inference<span class="sc">$</span>Comparison <span class="ot">&lt;-</span> i</span>
<span id="cb84-6"><a href="sec-basics.html#cb84-6" tabindex="-1"></a>  inference</span>
<span id="cb84-7"><a href="sec-basics.html#cb84-7" tabindex="-1"></a>})</span>
<span id="cb84-8"><a href="sec-basics.html#cb84-8" tabindex="-1"></a>inferences <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, inferences) <span class="do">## combine in a single table</span></span>
<span id="cb84-9"><a href="sec-basics.html#cb84-9" tabindex="-1"></a>inferences<span class="sc">$</span>Comparison <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ridgecondition"</span>,<span class="st">""</span>, inferences<span class="sc">$</span>Comparison)</span></code></pre></div>
<p><strong>TODO</strong> I created a function <code>msqrobCollect()</code> to streamline the
table extraction above.</p>
<p>We plot the volcano plots with each comparison in a separate facet.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="sec-basics.html#cb85-1" tabindex="-1"></a>inferences <span class="sc">|&gt;</span></span>
<span id="cb85-2"><a href="sec-basics.html#cb85-2" tabindex="-1"></a>  <span class="fu">na.exclude</span>() <span class="sc">|&gt;</span> </span>
<span id="cb85-3"><a href="sec-basics.html#cb85-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb85-4"><a href="sec-basics.html#cb85-4" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> logFC,</span>
<span id="cb85-5"><a href="sec-basics.html#cb85-5" tabindex="-1"></a>        <span class="at">y =</span> <span class="sc">-</span><span class="fu">log10</span>(pval),</span>
<span id="cb85-6"><a href="sec-basics.html#cb85-6" tabindex="-1"></a>        <span class="at">shape =</span> adjPval <span class="sc">&lt;</span> <span class="fl">0.05</span>,</span>
<span id="cb85-7"><a href="sec-basics.html#cb85-7" tabindex="-1"></a>        <span class="at">color =</span> isEcoli)) <span class="sc">+</span></span>
<span id="cb85-8"><a href="sec-basics.html#cb85-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb85-9"><a href="sec-basics.html#cb85-9" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb85-10"><a href="sec-basics.html#cb85-10" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey20"</span>, <span class="st">"firebrick"</span>), <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb85-11"><a href="sec-basics.html#cb85-11" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Human proteins"</span>, <span class="st">"Ecoli spikein"</span>)</span>
<span id="cb85-12"><a href="sec-basics.html#cb85-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb85-13"><a href="sec-basics.html#cb85-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Comparison) <span class="sc">+</span></span>
<span id="cb85-14"><a href="sec-basics.html#cb85-14" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Statistical inference for all pairwise comparisons"</span>) </span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-68-1.png" alt="plot of chunk unnamed-chunk-68"><div class="figcaption">plot of chunk unnamed-chunk-68</div>
</div>
<p>Since we know the ground truth we can again evaluate the number of
true positives, false positives and false discovery proportion.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="sec-basics.html#cb86-1" tabindex="-1"></a>inferences <span class="sc">|&gt;</span> </span>
<span id="cb86-2"><a href="sec-basics.html#cb86-2" tabindex="-1"></a>  <span class="fu">filter</span>(adjPval <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">|&gt;</span> </span>
<span id="cb86-3"><a href="sec-basics.html#cb86-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Comparison) <span class="sc">|&gt;</span> </span>
<span id="cb86-4"><a href="sec-basics.html#cb86-4" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb86-5"><a href="sec-basics.html#cb86-5" tabindex="-1"></a>    <span class="at">fp =</span> <span class="fu">sum</span>(<span class="sc">!</span>isEcoli), </span>
<span id="cb86-6"><a href="sec-basics.html#cb86-6" tabindex="-1"></a>    <span class="at">tp =</span> <span class="fu">sum</span>(isEcoli), </span>
<span id="cb86-7"><a href="sec-basics.html#cb86-7" tabindex="-1"></a>    <span class="at">fdp =</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="sc">!</span>isEcoli)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## # A tibble: 10 × 4
##    Comparison    fp    tp   fdp
##    &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
##  1 b             19   443  4.11
##  2 c             28   535  4.97
##  3 c - b         22   327  6.3 
##  4 d             28   581  4.6 
##  5 d - b         27   517  4.96
##  6 d - c          5   249  1.97
##  7 e             54   603  8.22
##  8 e - b         47   578  7.52
##  9 e - c         20   501  3.84
## 10 e - d          5   286  1.72</code></pre>
<p>We can also assess the fold changes, but we first create a small table
with the real values.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="sec-basics.html#cb88-1" tabindex="-1"></a>realLogFC <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb88-2"><a href="sec-basics.html#cb88-2" tabindex="-1"></a>  <span class="at">logFC =</span> <span class="fu">t</span>(L) <span class="sc">%*%</span> <span class="fu">lm</span>(<span class="fu">log2</span>(concentration) <span class="sc">~</span> condition, <span class="fu">colData</span>(spikein))<span class="sc">$</span>coef[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb88-3"><a href="sec-basics.html#cb88-3" tabindex="-1"></a>)</span>
<span id="cb88-4"><a href="sec-basics.html#cb88-4" tabindex="-1"></a>realLogFC<span class="sc">$</span>Comparison <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"ridgecondition"</span>,<span class="st">""</span>,<span class="fu">colnames</span>(L))</span></code></pre></div>
<p>We can now create the boxplots with the estimated log2-fold changes,
adding horizontal lines with the corresponding target values.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="sec-basics.html#cb89-1" tabindex="-1"></a>inferences <span class="sc">|&gt;</span></span>
<span id="cb89-2"><a href="sec-basics.html#cb89-2" tabindex="-1"></a>  <span class="fu">na.exclude</span>() <span class="sc">|&gt;</span> </span>
<span id="cb89-3"><a href="sec-basics.html#cb89-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb89-4"><a href="sec-basics.html#cb89-4" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> logFC,</span>
<span id="cb89-5"><a href="sec-basics.html#cb89-5" tabindex="-1"></a>        <span class="at">x =</span> isEcoli,</span>
<span id="cb89-6"><a href="sec-basics.html#cb89-6" tabindex="-1"></a>        <span class="at">colour =</span> isEcoli)) <span class="sc">+</span></span>
<span id="cb89-7"><a href="sec-basics.html#cb89-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()  <span class="sc">+</span></span>
<span id="cb89-8"><a href="sec-basics.html#cb89-8" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb89-9"><a href="sec-basics.html#cb89-9" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey20"</span>, <span class="st">"firebrick"</span>), <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb89-10"><a href="sec-basics.html#cb89-10" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Human proteins"</span>, <span class="st">"E. coli proteins"</span>)</span>
<span id="cb89-11"><a href="sec-basics.html#cb89-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-12"><a href="sec-basics.html#cb89-12" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Comparison) <span class="sc">+</span></span>
<span id="cb89-13"><a href="sec-basics.html#cb89-13" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> realLogFC, <span class="fu">aes</span>(<span class="at">yintercept =</span> logFC), </span>
<span id="cb89-14"><a href="sec-basics.html#cb89-14" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span></span>
<span id="cb89-15"><a href="sec-basics.html#cb89-15" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-71-1.png" alt="plot of chunk unnamed-chunk-71"><div class="figcaption">plot of chunk unnamed-chunk-71</div>
</div>
</div>
<div id="model-the-spike-in-concentration-as-a-numeric" class="section level3" number="2.8.2">
<h3>
<span class="header-section-number">2.8.2</span> Model the spike-in concentration as a numeric<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('model-the-spike-in-concentration-as-a-numeric')" onmouseout="reset_tooltip('model-the-spike-in-concentration-as-a-numeric-tooltip')"><span class="tooltiptext" id="model-the-spike-in-concentration-as-a-numeric-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>Since the relative concentration of the E. coli spike-in lysate is
known, we can also model the effect of the treatment using the
log2-transformed spike-in concentration as a continuous covariate. We
then expect the slope to be close to 1 for E. coli proteins.</p>
<ol style="list-style-type: decimal">
<li>We first create a variable with log2 transformed concentration in
the <code>colData</code>.</li>
<li>We fit an msqrob model using the log2 transformed concentration as
a fixed effect. Note, that we set <code>ridge = FALSE</code> because we only
have one slope parameter in the model. We store the models in a new
column with name <code>"concentration_model"</code>.</li>
<li>We setup a contrast for the slope term.</li>
<li>We conduct the hypothesis test for all proteins.</li>
</ol>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="sec-basics.html#cb90-1" tabindex="-1"></a>spikein<span class="sc">$</span>concentration_log2 <span class="ot">&lt;-</span> <span class="fu">log2</span>(spikein<span class="sc">$</span>concentration) <span class="co">#1.</span></span>
<span id="cb90-2"><a href="sec-basics.html#cb90-2" tabindex="-1"></a>spikein <span class="ot">&lt;-</span> <span class="fu">msqrob</span>( <span class="co">#2.</span></span>
<span id="cb90-3"><a href="sec-basics.html#cb90-3" tabindex="-1"></a>  spikein, <span class="at">i =</span> <span class="st">"proteins"</span>,</span>
<span id="cb90-4"><a href="sec-basics.html#cb90-4" tabindex="-1"></a>  <span class="at">formula =</span> <span class="sc">~</span> concentration_log2,</span>
<span id="cb90-5"><a href="sec-basics.html#cb90-5" tabindex="-1"></a>  <span class="at">ridge =</span> <span class="cn">FALSE</span>,</span>
<span id="cb90-6"><a href="sec-basics.html#cb90-6" tabindex="-1"></a>  <span class="at">robust =</span> <span class="cn">TRUE</span>, </span>
<span id="cb90-7"><a href="sec-basics.html#cb90-7" tabindex="-1"></a>  <span class="at">modelColumnName =</span> <span class="st">"concentration_model"</span></span>
<span id="cb90-8"><a href="sec-basics.html#cb90-8" tabindex="-1"></a>)</span>
<span id="cb90-9"><a href="sec-basics.html#cb90-9" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">makeContrast</span>( <span class="co">#3.</span></span>
<span id="cb90-10"><a href="sec-basics.html#cb90-10" tabindex="-1"></a>  <span class="st">"concentration_log2 = 0"</span>, <span class="at">parameterNames =</span> <span class="st">"concentration_log2"</span></span>
<span id="cb90-11"><a href="sec-basics.html#cb90-11" tabindex="-1"></a>)</span>
<span id="cb90-12"><a href="sec-basics.html#cb90-12" tabindex="-1"></a>spikein <span class="ot">&lt;-</span> <span class="fu">hypothesisTest</span>( <span class="co">#4.</span></span>
<span id="cb90-13"><a href="sec-basics.html#cb90-13" tabindex="-1"></a>  spikein, <span class="at">i =</span> <span class="st">"proteins"</span>, L, <span class="at">modelColumn =</span> <span class="st">"concentration_model"</span>,</span>
<span id="cb90-14"><a href="sec-basics.html#cb90-14" tabindex="-1"></a>  <span class="at">overwrite =</span> <span class="cn">TRUE</span></span>
<span id="cb90-15"><a href="sec-basics.html#cb90-15" tabindex="-1"></a>)</span></code></pre></div>
<p>We plot the results using the volcano plot as in the previous section.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="sec-basics.html#cb91-1" tabindex="-1"></a>inference <span class="ot">&lt;-</span> <span class="fu">rowData</span>(spikein[[<span class="st">"proteins"</span>]])[, <span class="fu">colnames</span>(L)]</span>
<span id="cb91-2"><a href="sec-basics.html#cb91-2" tabindex="-1"></a>inference<span class="sc">$</span>Protein <span class="ot">&lt;-</span> <span class="fu">rownames</span>(inference)</span>
<span id="cb91-3"><a href="sec-basics.html#cb91-3" tabindex="-1"></a>inference<span class="sc">$</span>isEcoli <span class="ot">&lt;-</span> inference<span class="sc">$</span>Protein <span class="sc">%in%</span> ecoli</span>
<span id="cb91-4"><a href="sec-basics.html#cb91-4" tabindex="-1"></a>inference <span class="sc">|&gt;</span></span>
<span id="cb91-5"><a href="sec-basics.html#cb91-5" tabindex="-1"></a>  <span class="fu">na.exclude</span>() <span class="sc">|&gt;</span></span>
<span id="cb91-6"><a href="sec-basics.html#cb91-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb91-7"><a href="sec-basics.html#cb91-7" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> logFC,</span>
<span id="cb91-8"><a href="sec-basics.html#cb91-8" tabindex="-1"></a>        <span class="at">y =</span> <span class="sc">-</span><span class="fu">log10</span>(adjPval),</span>
<span id="cb91-9"><a href="sec-basics.html#cb91-9" tabindex="-1"></a>        <span class="at">color =</span> isEcoli)) <span class="sc">+</span></span>
<span id="cb91-10"><a href="sec-basics.html#cb91-10" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb91-11"><a href="sec-basics.html#cb91-11" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fu">log10</span>(<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb91-12"><a href="sec-basics.html#cb91-12" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb91-13"><a href="sec-basics.html#cb91-13" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb91-14"><a href="sec-basics.html#cb91-14" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey20"</span>, <span class="st">"firebrick"</span>), <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb91-15"><a href="sec-basics.html#cb91-15" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Human proteins"</span>, <span class="st">"Ecoli spikein"</span>)</span>
<span id="cb91-16"><a href="sec-basics.html#cb91-16" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb91-17"><a href="sec-basics.html#cb91-17" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Statistical inference results"</span>,</span>
<span id="cb91-18"><a href="sec-basics.html#cb91-18" tabindex="-1"></a>          <span class="fu">paste0</span>(<span class="st">"Hypothesis test: "</span>, <span class="fu">colnames</span>(L), <span class="st">" = 0"</span>))</span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-73-1.png" alt="plot of chunk unnamed-chunk-73"><div class="figcaption">plot of chunk unnamed-chunk-73</div>
</div>
<p>Similarly, we plot the estimated log2 concentration slope against the
expected value.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="sec-basics.html#cb92-1" tabindex="-1"></a>inference <span class="sc">|&gt;</span></span>
<span id="cb92-2"><a href="sec-basics.html#cb92-2" tabindex="-1"></a>  <span class="fu">na.exclude</span>() <span class="sc">|&gt;</span></span>
<span id="cb92-3"><a href="sec-basics.html#cb92-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb92-4"><a href="sec-basics.html#cb92-4" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> logFC,</span>
<span id="cb92-5"><a href="sec-basics.html#cb92-5" tabindex="-1"></a>        <span class="at">x =</span> isEcoli,</span>
<span id="cb92-6"><a href="sec-basics.html#cb92-6" tabindex="-1"></a>        <span class="at">colour =</span> isEcoli)) <span class="sc">+</span></span>
<span id="cb92-7"><a href="sec-basics.html#cb92-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()  <span class="sc">+</span></span>
<span id="cb92-8"><a href="sec-basics.html#cb92-8" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb92-9"><a href="sec-basics.html#cb92-9" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey20"</span>, <span class="st">"firebrick"</span>), <span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb92-10"><a href="sec-basics.html#cb92-10" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Human proteins"</span>, <span class="st">"E. coli proteins"</span>)</span>
<span id="cb92-11"><a href="sec-basics.html#cb92-11" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb92-12"><a href="sec-basics.html#cb92-12" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb92-13"><a href="sec-basics.html#cb92-13" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"firebrick"</span>)</span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-74-1.png" alt="plot of chunk unnamed-chunk-74"><div class="figcaption">plot of chunk unnamed-chunk-74</div>
</div>
<p>Note, that the slopes for the human and E. coli proteins are centered
around 0 and 1, respectively. However, they seem to be slightly
biased. Probably again because of ion supression effects in the high
spike in conditions.</p>
</div>
</div>
<div id="conclusion" class="section level2" number="2.9">
<h2>
<span class="header-section-number">2.9</span> Conclusion<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('conclusion')" onmouseout="reset_tooltip('conclusion-tooltip')"><span class="tooltiptext" id="conclusion-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>In this vignette, we have demonstrated a typical data analysis
workflow for label free data using <code>msqrob2</code>. Because the packages
relies on the <code>QFeatures</code> data class, we could demonstrate the
implementation of a complete pre-processing workflow starting from
MaxQuant’s peptide table: log2-transformation, PSM filtering, missing
value management, normalisation, and summarisation. The data
exploration revealed expected patterns of variation among samples, as
this is a ground truth data set.</p>
<p>Once pre-processed, we use the <code>msqrob2</code> package to model the (known)
effect of spike-in condition. We showed how to run statistical
inference on the modelling results to retrieve the significance of
differentially abundant proteins. We explored statistical results
through volcano plots and boxplots of the log2 fold changes and
visually validated the results for one protein by plotting the input
data. We have shown the inference pipeline can be streamlined when
having multiple hypotheses to test. In this example, the spike-in
condition can be encoded as a categorical variable or a numeric
variable, and we showed how to model and interpret the results for
both cases.</p>
<p>This chapter hence provides a general framework for analysing simple
experimental designs for label-free proteomics experiments. Remember,
this book provides <a href="index.html#sec-overview_use_cases">an overview</a> of different
use cases with more complex designs. In the next chapter, we will
illustrate advanced concepts of proteomics data analysis, illustrated
by the analysis of a TMT-labelled spike-in experiment.</p>

</div>
</div>
<p style="text-align: center;">
<a href="index.html"><button class="btn btn-default">Previous</button></a>
<a href="sec-advanced.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2025-11-12
 using 
R version 4.5.2 (2025-10-31)
</p>
</div>
</div>



</body>
</html>
